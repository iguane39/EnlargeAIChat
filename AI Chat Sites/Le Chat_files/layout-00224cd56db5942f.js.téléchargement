try{let e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b7516b4e-390f-41c5-bb82-77404032d835",e._sentryDebugIdIdentifier="sentry-dbid-b7516b4e-390f-41c5-bb82-77404032d835")}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4944],{3819:(e,t,n)=>{"use strict";n.d(t,{l:()=>u,m:()=>d});var s=n(64784),a=n(8380),r=n(30063);let i=(0,a.createContext)(null);var l=n(55796),o=n(6016);function c(e){let{data:t,size:n=320,animation:r=null}=e,i=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let e=i.current;if(!e)return;e.width=n,e.height=n;let s=e.getContext("2d",{alpha:!0});if(!s)return;s.imageSmoothingEnabled=!1,s.clearRect(0,0,e.width,e.height);let a=n/t.length;for(let[e,n]of t.entries())for(let[t,r]of n.entries())r&&(s.fillStyle=r,s.fillRect(Math.round(t*a),Math.round(e*a),Math.round(a),Math.round(a)))},[t,n]),(0,s.jsx)(o.P.canvas,{..."entry"===r?{initial:{opacity:0,y:8},animate:{opacity:1,y:0}}:"hovering"===r?{initial:{y:-1},animate:{y:1},transition:{repeat:1/0,repeatType:"reverse",ease:"easeInOut",duration:.75}}:{},ref:i,width:n,height:n,style:{imageRendering:"pixelated",padding:"10%"}})}function d(e){let{children:t,avatar:n,className:l,...o}=e,c=(0,a.useMemo)(()=>({avatar:n}),[n]);return(0,s.jsx)(i.Provider,{value:c,children:(0,s.jsx)("div",{style:"pixel_avatar"===n.type?{backgroundColor:n.background_color}:void 0,className:(0,r.cn)("brand_avatar"===n.type&&"bg-muted dark:bg-(--neutral-700)",l),...o,children:t})})}function u(e){let t=(0,a.useContext)(i);if(!t)throw Error("AgentAvatar must be used within an AgentAvatarContainer");switch(t.avatar.type){case"pixel_avatar":return(0,s.jsx)(c,{data:t.avatar.pixels,...e});case"brand_avatar":return(0,s.jsx)(l.m,{brandAvatarId:t.avatar.brand_avatar_id,...e});default:return null}}},6270:(e,t,n)=>{"use strict";n.d(t,{$:()=>l});var s=n(93706),a=n(8380),r=n(51039),i=n(88544);function l(){let e=(0,s.c3)("Chat.files");return{getReferenceSourceDisplayName:(0,a.useCallback)(t=>{var n,s,a;if((0,i.a7)(t,t.metadata))return t.metadata?t.metadata.library_name:e("document_library.libraries");let l=(0,r.Ax)(t);return(a=null!=l?l:null)&&[r.Mv,r.kY,r.K2].includes(a)?null==l?void 0:l.toLocaleUpperCase():null!=(s=null!=l?l:null==(n=t.source)?void 0:n.toUpperCase())?s:""},[e])}}},6734:(e,t,n)=>{"use strict";n.d(t,{R:()=>o});var s=n(64784),a=n(8380),r=n(56337),i=n(30063);let l=e=>!!e;function o(e){let{children:t,className:n,onDrop:o,shouldHighlight:c=l}=e,d=(0,r.yy)(c),[u,h]=(0,a.useState)(!1),m=()=>{h(!1)};return(0,s.jsx)("div",{onDragOver:e=>{e.preventDefault(),h(!0)},onDragLeave:m,onDragExit:m,onDrop:e=>{h(!1),null==o||o(e)},"data-highlighted":d||void 0,"data-dragover":u||void 0,className:(0,i.cn)("z-30 overflow-hidden transition-all",u&&"cursor-copy rounded-md inset-ring",n),children:t})}},9855:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var s=n(47097);function a(...e){return(0,s.T)(r,e)}let r=e=>`${e[0]?.toUpperCase()??""}${e.slice(1)}`},10834:(e,t,n)=>{"use strict";n.d(t,{Cmdk:()=>e_});var s=n(64784),a=n(93706),r=n(8380),i=n(9855),l=n(32735),o=n(42573),c=n(32987),d=n(91518),u=n(55833),h=n(15548),m=n(17027),p=n(8424),x=n(801);let f=(0,r.createContext)(null),g=(0,n(47795).tv)({slots:{command:"bg-default text-default flex h-full w-full flex-col overflow-hidden rounded-md",dialogCommandContent:"p-0 shadow-lg translate-y-0 top-1/6 max-h-[calc(5/6*100vh-4px)]",dialogCommand:"[&_[cmdk-group-heading]]:text-muted [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",inputContainer:"has-[input:focus]:ring-0 rounded-b-none border-t-0 border-s-0 border-e-0 has-[input:focus]:shadow-none bg-transparent",list:"overflow-y-auto overflow-x-hidden transition-all max-h-[calc(5/6*100vh-120px)] h-(--cmdk-list-height)",empty:"text-center text-sm text-subtle",group:"text-default [&_[cmdk-group-heading]]:text-muted overflow-hidden [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",item:"gap-2 text-subtle aria-selected:bg-state-soft aria-selected:text-default outline-hidden relative flex cursor-default select-none items-center rounded-sm text-sm data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",itemAsideIcon:"size-[1.25em]",separator:"border-default -mx-1 border",loading:"flex flex-row items-center justify-center gap-2 text-hint text-sm"},variants:{size:{default:{item:"px-2 py-1.5",group:"p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5",empty:"py-6"},lg:{item:"px-4 py-2",group:"p-1 [&_[cmdk-group-heading]]:px-4 [&_[cmdk-group-heading]]:py-2",empty:"py-8",inputContainer:"h-12"}}},defaultVariants:{}});function v(e){let{className:t,size:n,...a}=e,i=(0,r.useMemo)(()=>({styles:g({size:n}),variants:{size:n}}),[n]);return(0,s.jsx)(f.Provider,{value:i,children:(0,s.jsx)(u.uB,{className:i.styles.command({className:t}),...a})})}function j(e){let{className:t,...n}=e,a=(0,r.useContext)(f);if(!a)throw Error("CommandInput must be used within a Command");return(0,s.jsx)(x.A0,{className:a.styles.inputContainer({className:t}),children:(0,s.jsx)(u.uB.Input,{asChild:!0,...n,children:(0,s.jsx)(x.pd,{size:"lg"===a.variants.size?"lg":"sm"})})})}function b(e){let{className:t,...n}=e,a=(0,r.useContext)(f);if(!a)throw Error("CommandList must be used within a Command");return(0,s.jsx)(u.uB.List,{className:a.styles.list({className:t}),...n})}function y(e){let{className:t,...n}=e,a=(0,r.useContext)(f);if(!a)throw Error("CommandEmpty must be used within a Command");return(0,s.jsx)(u.uB.Empty,{className:a.styles.empty({className:t}),...n})}function _(e){let{className:t,...n}=e,a=(0,r.useContext)(f);if(!a)throw Error("CommandGroup must be used within a Command");return(0,s.jsx)(u.uB.Group,{className:a.styles.group({className:t}),...n})}function N(e){let{className:t,...n}=e,a=(0,r.useContext)(f);if(!a)throw Error("CommandItem must be used within a Command");return(0,s.jsx)(u.uB.Item,{className:a.styles.item({className:t}),...n})}function w(e){let t=(0,r.useContext)(f);if(!t)throw Error("CommandItemLeadIcon must be used within a CommandItem");return"icon"in e?(0,r.createElement)(e.icon,{className:t.styles.itemAsideIcon({className:e.className})}):e.children}function C(e){let t=(0,r.useContext)(f);if(!t)throw Error("CommandItemTailIcon must be used within a CommandItem");return"icon"in e?(0,r.createElement)(e.icon,{className:t.styles.itemAsideIcon({className:e.className})}):e.children}function P(e){let{children:t,className:n,...a}=e,r=g();return(0,s.jsx)(m.Dialog,{...a,children:(0,s.jsxs)(m.DialogContent,{hideX:!0,className:r.dialogCommandContent({className:n}),onEscapeKeyDown:e=>{e.preventDefault()},children:[(0,s.jsx)(p.s6o,{children:(0,s.jsx)(m.DialogTitle,{})}),t]})})}function k(e){let{className:t,children:n,...a}=e,i=(0,r.useContext)(f);if(!i)throw Error("CommandLoading must be used within a Command");return(0,s.jsxs)(u.uB.Loading,{className:i.styles.loading({className:t}),...a,children:[(0,s.jsx)(w,{children:(0,s.jsx)(h.A,{className:"size-[1em] animate-spin"})}),(0,s.jsx)("span",{children:n})]})}w.displayName="CommandItemLeadIcon",C.displayName="CommandItemTailIcon";var A=n(8866),I=n(38256),E=n(34435),S=n(55936),M=n(12330),D=n(28008),z=n(3819),T=n(35111),R=n(6016),L=n(50259);function O(e){let{label:t,hotkey:n}=e;return(0,s.jsxs)(R.P.div,{className:"flex items-center gap-1",initial:{opacity:0,x:-2},animate:{opacity:1,x:0},exit:{opacity:0,x:-2},children:[(0,s.jsx)(D.ac,{variant:"muted",size:"xs",children:t}),(0,s.jsx)(L.m,{size:"sm",hotkey:n,className:"text-hint"})]})}var B=n(5936),F=n(41585),G=n(30063);function U(e){let{children:t}=e;return(0,s.jsx)("div",{className:(0,G.cn)("flex h-0 items-center justify-end gap-4 border-t border-transparent bg-default px-4 transition-all duration-150",r.Children.toArray(t).some(F.z)&&"h-[38px] border-default"),children:(0,s.jsx)(B.N,{children:t})})}function H(e){var t;let{value:n,close:i}=e,l=T.api.agent.templates.useQuery(),o=T.api.agent.list.useQuery(),d=(0,M.useRouter)(),u=(0,a.c3)("General"),h=(0,r.useMemo)(()=>{var e;return null==(e=o.data)?void 0:e.find(e=>e.id===n)},[o.data,n]),m=(0,r.useMemo)(()=>{var e;return null==(e=l.data)?void 0:e.find(e=>e.id===n)},[l.data,n]),p=T.api.useUtils(),x=T.api.agent.create.useMutation({onSuccess(){p.agent.list.invalidate()}});return(0,c.E)("mod+e",()=>{h&&"write"===h.access?(d.push("/agents/".concat(h.id)),i()):m&&x.mutateAsync({templateId:m.id}).then(e=>{d.push("/agents/".concat(e.id)),i()})}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{children:o.isLoading||!o.data?(0,s.jsx)(k,{children:u("command_k.loading_placeholder")}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(_,{children:(0,s.jsxs)(N,{value:"agents",keywords:["agents"],onSelect:()=>{d.push("/agents"),i()},children:[(0,s.jsx)(w,{icon:S.A}),(0,s.jsx)(D.ac,{className:"whitespace-nowrap",children:u("command_k.agents.go_to_agents")})]})}),(0,s.jsx)(_,{heading:u("command_k.agents.my_agents_heading"),children:o.data.map(e=>{var t;return(0,s.jsxs)(N,{value:e.id,keywords:[e.name,...null!=(t=e.description)?t:[]],onSelect:()=>{d.push("/chat?le-chat-agent=".concat(e.id)),i()},children:[e.avatar&&(0,s.jsx)(z.m,{avatar:e.avatar,className:"flex size-[24px] shrink-0 items-center justify-center rounded-[4px]",children:(0,s.jsx)(z.l,{size:16})}),(0,s.jsx)(D.ac,{className:"whitespace-nowrap",children:e.name}),e.description&&(0,s.jsx)(D.ac,{variant:"hint",className:"truncate",children:e.description})]},e.id)})}),(0,s.jsx)(_,{heading:u("command_k.agents.templates_heading"),children:null==(t=l.data)?void 0:t.map(e=>(0,s.jsxs)(N,{value:e.id,keywords:[e.name,e.description],onSelect:()=>x.mutateAsync({templateId:e.id}).then(e=>{d.push("/chat?le-chat-agent=".concat(e.id)),i()}),children:[(0,s.jsx)(z.m,{avatar:e.avatar,className:"flex size-[24px] shrink-0 items-center justify-center rounded-[4px]",children:(0,s.jsx)(z.l,{size:16})}),(0,s.jsx)(D.ac,{className:"whitespace-nowrap",children:e.name}),e.description&&(0,s.jsx)(D.ac,{variant:"hint",className:"truncate",children:e.description})]},e.id))})]})}),(0,s.jsx)(U,{children:h?(0,s.jsxs)(s.Fragment,{children:["write"===h.access&&(0,s.jsx)(O,{label:u("command_k.agents.actions.edit"),hotkey:"mod+e"}),(0,s.jsx)(O,{label:u("command_k.agents.actions.start_new_chat"),hotkey:"⏎"})]}):m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(O,{label:u("command_k.agents.actions.edit_template"),hotkey:"mod+e"}),(0,s.jsx)(O,{label:u("command_k.agents.actions.start_new_chat_from_template"),hotkey:"⏎"})]}):null})]})}var W=n(98612),V=n(64371);function $(e){let{value:t,title:n,excerpt:a,date:i,onSelect:l}=e,o=(0,V.Ym)(),c=(0,r.useMemo)(()=>new Intl.DateTimeFormat(o,{day:"numeric",month:"long",year:(0,W.s)(i,new Date)?void 0:"numeric"}).format(i),[i,o]);return(0,s.jsxs)(N,{forceMount:!0,value:t,onSelect:l,className:"block space-y-1.5",children:[(0,s.jsxs)(D.r6,{size:"xs",weight:"medium",children:[n,(0,s.jsxs)(D.ac,{variant:"muted",weight:"normal",children:[" - ",c]})]}),(0,s.jsx)(D.r6,{size:"2xs",className:"truncate",variant:"subtle",children:a})]},t)}let K=(0,r.memo)(e=>{let{text:t,query:n}=e,a=t.split(/(<b>|<\/b>)/),r=t.includes("<b>")||t.includes("</b>");return(0,s.jsx)(s.Fragment,{children:a.map((e,t)=>{if("<b>"===e)return(0,s.jsx)("strong",{className:"text-default",children:a[t+1]},t);if("</b>"===e||"<b>"===a[t-1])return null;if(!r&&n&&e.includes(n)){let a=e.split(RegExp("(".concat(n,")"),"gi"));return(0,s.jsx)("span",{children:a.map((e,t)=>e.toLowerCase()===n.toLowerCase()?(0,s.jsx)("strong",{className:"text-default",children:e},t):e)},t)}return e})})});function Y(e){let{search:t,close:n}=e,[r]=(0,o.Q3)(t,500),i=(0,M.useRouter)(),l=(0,a.c3)("General"),c=t.trim().length>=3,d=T.api.message.search.useQuery({query:r},{enabled:c});return c?(0,s.jsx)(_,{forceMount:!0,heading:l("command_k.search.results_in_your_chats",{search:r}),children:d.data?d.data.items.length>0?d.data.items.map(e=>{var a;return(0,s.jsx)($,{onSelect:()=>{i.push("/chat/".concat(e.chatId)),n()},value:e.id,title:null!=(a=e.title)?a:"",excerpt:(0,s.jsx)(K,{text:e.highlight,query:t}),date:e.timestamp},e.id)}):null:(0,s.jsxs)(N,{forceMount:!0,children:[(0,s.jsx)(w,{icon:h.A,className:"animate-spin text-hint"}),l("command_k.search.searching")]},"pending-search")}):null}function Q(e){let{search:t,close:n}=e,a=T.api.chat.last.useQuery({},{}),r=(0,M.useRouter)();return(0,s.jsx)(b,{children:t.trim().length>=3?(0,s.jsx)(Y,{search:t,close:n}):a.isLoading||!a.data?(0,s.jsx)(k,{children:"Hang on…"}):(0,s.jsx)(_,{children:a.data.items.map(e=>{var t;return(0,s.jsx)($,{value:e.id,title:e.generatedTitle||e.title||"",excerpt:null!=(t=e.title)?t:"",date:e.updatedAt,onSelect:()=>{r.push("/chat/".concat(e.id)),n()}},e.id)})})})}var J=n(57583),Z=n(72758),X=n(44533),q=n(43079),ee=n(33981),et=n(51327),en=n(81118),es=n(3905),ea=n(15826),er=n(92947),ei=n(94399),el=n(9243),eo=n(9317),ec=n(37984),ed=n(13797),eu=n(8492),eh=n(6974),em=n(87985),ep=n(17800);function ex(e){var t,n;let{search:r,value:i,pages:l,updatePages:o,close:d}=e,u=(0,M.useRouter)(),m=T.api.useUtils(),p=(0,a.c3)(),{setTheme:x,theme:f,resolvedTheme:g}=(0,ec.D)(),{desktopApi:v}=(0,eu.A)(),j=(0,I.w)(),y=!1;j&&(y=(0,ed.xQ)({userRole:j.session.role}));let P=T.api.agent.create.useMutation({onSuccess(e){m.agent.list.invalidate(),u.push("/agents/".concat(e.id)),d()}}),{mutate:k,isPending:A}=(0,ep.b)({onSuccess:e=>{let{id:t}=e;u.push("/projects/".concat(t,"?new=true")),d()}});return(0,c.E)("mod+enter",e=>{"theme"===i&&"system"!==f&&(x("system"),e.stopPropagation(),e.preventDefault(),d())},{capture:!0}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(b,{children:[(0,s.jsxs)(_,{heading:p("General.command_k.chats.heading"),children:[(0,s.jsxs)(N,{onSelect:()=>{u.push("/chat"),d()},children:[(0,s.jsx)(w,{icon:J.A}),p("General.command_k.chats.start_new_chat")]}),(0,s.jsxs)(N,{onSelect:()=>{u.push("/incognito"),d()},children:[(0,s.jsx)(w,{icon:Z.A}),p("General.command_k.chats.start_incognito_chat")]}),(0,s.jsxs)(N,{onSelect:()=>o([...l,"chats"]),children:[(0,s.jsx)(w,{icon:X.A}),p("General.command_k.chats.list_recent_chats")]})]}),(0,s.jsxs)(_,{heading:p("General.command_k.projects.heading"),children:[(0,s.jsxs)(N,{onSelect:()=>o([...l,"projects"]),children:[(0,s.jsx)(w,{icon:q.A}),p("General.command_k.projects.list_my_projects")]}),(0,s.jsxs)(N,{onSelect:()=>k({name:p("Projects.create.default_name")}),children:[(0,s.jsx)(w,{icon:ee.A}),p("General.command_k.projects.create_project"),(0,s.jsx)("span",{className:"grow"}),A&&(0,s.jsx)(C,{icon:h.A,className:"animate-spin text-hint"})]})]}),(0,s.jsxs)(_,{heading:p("General.command_k.agents.heading"),children:[(0,s.jsxs)(N,{onSelect:()=>o([...l,"agents"]),children:[(0,s.jsx)(w,{icon:et.A}),p("General.command_k.agents.list_my_agents")]}),(0,s.jsxs)(N,{onSelect:()=>{P.mutateAsync({name:p("Agents.list.new_agent_default_name")})},children:[(0,s.jsx)(w,{icon:en.A}),p("General.command_k.agents.create_an_agent"),(0,s.jsx)("span",{className:"grow"}),P.isPending&&(0,s.jsx)(C,{icon:h.A,className:"animate-spin text-hint"})]})]}),(0,s.jsxs)(_,{heading:p("General.command_k.intelligence.heading"),children:[(0,s.jsxs)(N,{onSelect:()=>o([...l,"libraries"]),children:[(0,s.jsx)(w,{icon:es.A}),p("General.command_k.libraries.open_a_document_library")]}),(0,s.jsxs)(N,{onSelect:()=>{u.push("/memories"),d()},children:[(0,s.jsx)(w,{icon:ea.A}),p("General.command_k.memories.my_memories_heading")]}),(0,s.jsxs)(N,{keywords:["mcp"],onSelect:()=>{u.push("/connectors"),d()},children:[(0,s.jsx)(w,{icon:er.A}),p("General.command_k.connectors.my_connectors_heading")]})]}),(0,s.jsxs)(_,{heading:p("General.command_k.settings.heading"),children:[y&&(0,s.jsxs)(N,{onSelect:()=>{u.push(eh._.NEXT_PUBLIC_SETTINGS_URL)},children:[(0,s.jsx)(w,{icon:ei.A}),p("General.command_k.settings.open_settings")]}),(0,s.jsxs)(N,{value:"theme",keywords:["change theme"],onSelect:()=>{x("light"===g?"dark":"light"),d()},children:[(0,s.jsx)(w,{icon:null!=(n=null==(t=em.F.find(e=>e.theme===f))?void 0:t.Icon)?n:el.A}),p("General.command_k.settings.change_theme")]}),(0,s.jsxs)(N,{onSelect:()=>{v?v.logout():u.push("/logout"),d()},children:[(0,s.jsx)(w,{icon:eo.A}),p("General.command_k.settings.logout")]})]}),(0,s.jsx)(Y,{search:r,close:d})]}),(0,s.jsxs)(U,{children:["theme"===i&&"system"!==f&&(0,s.jsx)(O,{label:p("General.command_k.settings.switch_to_system_theme"),hotkey:"mod+⏎"},"switch_to_system_theme"),"theme"===i&&(0,s.jsx)(O,{label:p("General.command_k.settings.switch_theme",{theme:"dark"===g?"light":"dark"}),hotkey:"⏎"},"switch_theme")]})]})}var ef=n(5508);function eg(e){let{value:t,close:n}=e,i=T.api.library.all.useQuery({types:["user","project"]}),l=(0,M.useRouter)(),o=(0,a.c3)("General"),d=(0,r.useMemo)(()=>{var e;return null==(e=i.data)?void 0:e.data.find(e=>e.id===t)},[i.data,t]);return(0,c.E)("mod+e",()=>{d&&(l.push("/libraries/".concat(d.id)),n())}),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(b,{children:[(0,s.jsx)(_,{children:(0,s.jsxs)(N,{value:"libraries",keywords:["libraries"],onSelect:()=>{l.push("/libraries"),n()},children:[(0,s.jsx)(w,{icon:S.A}),(0,s.jsx)(D.ac,{className:"whitespace-nowrap",children:o("command_k.libraries.go_to_libraries")})]})}),(0,s.jsx)(y,{children:"No results found."}),i.isLoading||!i.data?(0,s.jsx)(k,{children:o("command_k.loading_placeholder")}):(0,s.jsx)(_,{children:i.data.data.map(e=>(0,s.jsxs)(N,{value:e.id,onSelect:()=>{l.push("/chat?library=".concat(e.id)),n()},children:[(0,s.jsx)("div",{className:(0,G.cn)("flex size-6 items-center justify-center rounded-4",(0,G.Zh)(e.id)),children:(0,s.jsx)(ef.A,{className:(0,G.cn)("size-3 text-icon-white-subtle","mb-[0.5px]")})}),e.name]},e.id))})]}),(0,s.jsxs)(U,{children:[(0,s.jsx)(O,{label:o("command_k.libraries.actions.open"),hotkey:"mod+e"},"open"),(0,s.jsx)(O,{label:o("command_k.libraries.actions.start_new_chat"),hotkey:"⏎"},"start_new_chat")]})]})}var ev=n(64618);function ej(e){let{close:t}=e,{data:n,isLoading:r}=T.api.project.list.useQuery(),i=(0,M.useRouter)(),l=(0,a.c3)("General");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{children:r?(0,s.jsx)(k,{children:l("command_k.loading_placeholder")}):(0,s.jsx)(_,{heading:l("command_k.projects.my_projects_heading"),children:null==n?void 0:n.map(e=>(0,s.jsxs)(N,{value:e.id,keywords:[e.name],onSelect:()=>{i.push("/projects/".concat(e.id)),t()},children:[(0,s.jsx)(w,{icon:ev.A}),(0,s.jsx)(D.ac,{className:"whitespace-nowrap",children:e.name})]},e.id))})}),(0,s.jsx)(U,{children:(0,s.jsx)(O,{label:l("command_k.projects.actions.start_new_chat"),hotkey:"⏎"})})]})}var eb=n(82710);function ey(e){let{close:t}=e,{setTheme:n,theme:r}=(0,ec.D)(),i=(0,a.c3)("Chat");return(0,s.jsx)(b,{children:em.F.map(e=>{let{Icon:a,theme:l,labelKey:o}=e;return(0,s.jsxs)(N,{onSelect:()=>{n(l),t()},className:"justify-between",children:[(0,s.jsx)(w,{icon:a}),i(o),(0,s.jsx)("span",{className:"grow"}),r===l&&(0,s.jsx)(C,{icon:eb.A})]})})})}function e_(){let e=(0,a.c3)("General"),[t,n]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[m,p]=(0,r.useState)(["home"]),x=m.at(-1),{track:f}=(0,A.n)(),g=(0,I.w)(),{open:b,setOpen:y}=(0,E.Z)(),_=(0,o.DK)(()=>{y(!0),n(""),p(["home"]),g&&f(A.f.CMDK_OPEN)}),N=(0,o.DK)(()=>{y(!1)}),w=(0,o.DK)(e=>{p(e),n(""),g&&f(A.f.CMDK_VISIT_PAGE,{page:e.at(-1)})});return(0,c.E)("mod+k",b?N:_,{preventDefault:!0}),(0,s.jsx)(P,{open:b,onOpenChange:e=>e?_():N(),children:(0,s.jsxs)(v,{value:u,onValueChange:h,loop:!0,onKeyDown:e=>{if("Escape"===e.key||"Backspace"===e.key&&!t){if(e.preventDefault(),e.stopPropagation(),1===m.length)return N();w(m.slice(0,-1))}},size:"lg",children:[(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 px-2 pt-2",children:m.map(e=>(0,s.jsx)(d.Ex,{size:"sm",role:"button",onClick:()=>w("home"===e?["home"]:["home",e]),children:(0,i.Z)(e)},e))}),(0,s.jsx)(j,{value:t,onValueChange:n,placeholder:e("command_k.search_placeholder")})]}),(0,l.YW)(x).with("home",()=>(0,s.jsx)(ex,{value:u,search:t,pages:m,updatePages:w,close:N})).with("chats",()=>(0,s.jsx)(Q,{search:t,close:N})).with("theme",()=>(0,s.jsx)(ey,{close:N})).with("agents",()=>(0,s.jsx)(H,{value:u,close:N})).with("libraries",()=>(0,s.jsx)(eg,{value:u,close:N})).with("projects",()=>(0,s.jsx)(ej,{close:N})).otherwise(()=>null)]})})}},15541:(e,t,n)=>{"use strict";n.d(t,{default:()=>S});var s=n(64784),a=n(24180),r=n(5936),i=n(6016),l=n(52614),o=n(93706),c=n(8380),d=n(83145),u=n(71222),h=n(8672),m=n(39343),p=n(21104),x=n(51039),f=n(32987),g=n(8424),v=n(84544),j=n(8866),b=n(9360),y=n(35111),_=n(9624),N=n(28008),w=n(30063),C=n(90907),P=n(17210),k=n(6270);let A=e=>{let{reference:t,snippetContent:n}=e,a=(0,o.c3)("Chat");return(0,s.jsxs)(s.Fragment,{children:[t.date&&(0,s.jsx)("span",{children:"".concat((0,P.Wo)(new Date(t.date),{format:"short",yesterdayTranslation:a("left_panel.yesterday")})," - ")}),n.hasPreviousContent&&(0,s.jsx)("span",{className:(0,N.M0)({variant:"hint"}),children:"[...] "}),(0,s.jsx)("span",{dangerouslySetInnerHTML:{__html:n.text}}),n.hasNextContent&&(0,s.jsx)("span",{className:(0,N.M0)({variant:"hint"}),children:" [...]"})]})},I=e=>{var t;let{reference:n,handleClick:a,children:r}=e,i=(0,x.Ax)(n),{getReferenceSourceDisplayName:l}=(0,k.$)(),o=n.url&&n.source!==x.Mv,c=null!=(t=(0,x.vH)(n))?t:void 0,d=o&&c?"a":"div";return(0,s.jsxs)(d,{...o?{href:c,target:"_blank"}:{},onClick:n.source===x.Mv?void 0:a,className:(0,w.cn)("group/header flex flex-col gap-1 rounded-xl px-2 py-3",o?"hover:bg-muted":"",n.source===x.Mv?"select-none":""),children:[(0,s.jsxs)("div",{className:(0,w.cn)("flex w-full items-center justify-between gap-3"),children:[(0,s.jsxs)("div",{className:(0,w.cn)("flex grow flex-row-reverse items-center gap-2 overflow-hidden"),children:[i&&(0,s.jsx)(C.A,{height:20,width:20,hostname:i,className:"size-5"}),(0,s.jsx)("div",{className:(0,w.cn)("grow truncate text-end text-xs leading-4 font-medium text-subtle",o?"group-hover/header:text-default":""),children:l(n)})]}),i&&o&&(0,s.jsx)(_.A,{className:"size-4 text-icon-default-muted group-hover/header:text-icon-default"})]}),(0,s.jsx)(N.LJ,{className:(0,w.cn)("cursor-pointer leading-5 font-semibold text-ellipsis hover:underline",o?"group-hover/header:underline":"hover:underline",n.source===x.Mv?"":"group-hover/header:underline"),size:"sm",weight:"medium",variant:"default",onClick:n.source===x.Mv?a:void 0,children:n.title}),r]})};function E(e){let{reference:t,snippetContent:n,handleClick:a,multipleReferenceIndexes:r}=e;return null===n?null:(0,s.jsx)(I,{reference:t,handleClick:a,multipleReferenceIndexes:r,children:n.text&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("p",{className:(0,w.cn)("line-clamp-3 overflow-hidden pt-1 pb-0 text-sm leading-5.5 text-muted select-text",t.source===x.Mv?"select-none":""),children:(0,s.jsx)(A,{reference:t,snippetContent:n})})})})}function S(){var e;let t=(0,o.c3)("Chat"),{trackMessageEvent:n}=(0,j.n)(),_=b.P.use.referencesPanelMsgData(),[N,w]=(0,c.useState)(null),[C,P]=(0,c.useState)(null);(0,f.E)("esc",()=>{w(!1)},{preventDefault:!0,isDisabled:!1===N});let[k,A]=(0,c.useState)(!1),[I,S]=(0,c.useState)({}),M=y.api.reference.getAFPArticle.useMutation({onSuccess:e=>{S(t=>({...t,html:e,status:{name:"loaded"}}))},onError:e=>{S(t=>{var n;return{...t,status:{name:"error",code:null==(n=e.data)?void 0:n.code}}})}});(0,c.useEffect)(()=>{w(e=>!(!e||(0,u.H)(C,_))||!(0,h.u)(e)&&!!_&&!e)},[_,P,w]);let D=(0,a.useQuery)({queryKey:["references",null==_?void 0:_.id],queryFn:async()=>{if(!_)return w(!1),[];let e=(0,p.yY)(_.contentChunks,_.references),t=[];return _.contentChunks?Promise.all(_.contentChunks.map(async(n,s)=>{if("reference"===n.type)return await Promise.all(n.referenceIds.map(async n=>{let{reference:a,refIndex:r}=(0,m.t3)(_.references,n.toString());if(!a||t.map(e=>e.id).includes(a.id))return;let i=await (0,p.DB)(a,e,s);return{...a,content:i.text,index:r}}))})).then(e=>e.filter(Boolean).flat(1)):[]}});return(0,s.jsxs)(s.Fragment,{children:[N&&(0,s.jsx)("div",{className:"absolute start-0 end-0 top-0 bottom-0 z-45 flex h-full bg-overlay md:hidden",onClick:()=>w(!1)}),(0,s.jsx)(r.N,{children:N&&(0,s.jsx)(i.P.div,{initial:{width:0,insetInlineEnd:"-320px"},animate:{width:"320px",insetInlineEnd:0},exit:{width:0,insetInlineEnd:"-320px"},transition:{duration:.3,ease:"easeInOut"},className:"absolute top-0 bottom-0 z-45 border-s border-default md:relative",children:(0,s.jsxs)("div",{className:"relative flex h-full w-80 flex-col bg-subtle py-2 ps-2",children:[(0,s.jsxs)("div",{className:"flex items-center py-1 ps-3",children:[(0,s.jsx)("div",{className:"text-xl font-semibold text-default",children:t("references_panel.panel_title")}),(0,s.jsx)(g.$nd,{size:"sm",variant:"ghost",className:"ms-auto px-2.5",onClick:()=>w(!1),children:(0,s.jsx)(l.A,{className:"size-5"})})]}),(0,s.jsxs)(g.FKN,{children:[(0,s.jsx)(g.$H1,{dir:"vertical"}),(0,s.jsx)("div",{className:"mb-4 h-full overflow-y-auto ps-1 pe-2",children:(null!=(e=D.data)?e:[]).reduce((e,t)=>{if(!t)return e;let n=e.find(e=>e.id===t.id&&e.source===t.source&&e.title===t.title&&e.content===t.content);return n&&t.index?(n.aggregatedIndexes.push(t.index),n.aggregatedIndexes=(0,d.A)(n.aggregatedIndexes)):e.push({...t,aggregatedIndexes:t.index?[t.index]:[]}),e},[]).map((e,t)=>(0,s.jsx)(E,{reference:e,snippetContent:{text:e.content},handleClick:()=>(e=>{if(e.source===x.Mv){var t;M.mutate({articleId:null!=(t=e.url)?t:"",messageData:_}),A(!0),S(t=>{var n;return{...t,status:{name:"loading"},title:e.title,date:null!=(n=e.date)?n:""}})}else n(j.f.REFERENCE_CLICKED,{chat_id:null==_?void 0:_.chatId,message_id:null==_?void 0:_.id,message_version:null==_?void 0:_.version,reference_url:e.url,reference_source:e.source,answer_id:null==_?void 0:_.id,answer_version:null==_?void 0:_.version})})(e),multipleReferenceIndexes:e.aggregatedIndexes},"ref-".concat(t,"-").concat(e.id,"-").concat(e.source,"-").concat(e.title)))})]})]})})}),(0,s.jsx)(v.A,{article:I,isOpen:k,handleDialogOpenChange:A})]})}},17210:(e,t,n)=>{"use strict";function s(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function a(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:"long",yesterdayTranslation:null},n=new Date,a=e.toLocaleTimeString(void 0,{hour:"numeric",minute:"numeric"}),r=e.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit"}),i=e.toLocaleDateString(void 0,{day:"2-digit",month:"2-digit",year:"numeric"});if(s(n,e))return a;let l=new Date;l.setDate(n.getDate()-1);let{format:o,yesterdayTranslation:c}=t;return s(l,e)&&c?"long"===o?"".concat(c,", ").concat(a):c:n.getFullYear()===e.getFullYear()?"long"===o?"".concat(r," ").concat(a):i:i+("long"===o?" ".concat(a):"")}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{locale:navigator.language,yesterdayTranslation:null,format:"relative"},n=new Date(e),s=a(new Date),r=new Date(s);r.setDate(s.getDate()-1);let i=a(n),l=i.getTime()===s.getTime(),o=i.getTime()===r.getTime(),{format:c,locale:d,yesterdayTranslation:u}=t,h=new Intl.DateTimeFormat(d,{hour:"numeric",minute:"2-digit"}),m=new Intl.DateTimeFormat(d,{month:"short",day:"numeric"}),p=h.format(n);/AM|PM/i.test(p)&&(p=p.replace(/\s?(AM|PM)/i,(e,t)=>t.toLowerCase()));let x="".concat(m.format(n),", ").concat(p);return"long"===c?x:l?p:o&&u?"".concat(u," ").concat(p):x}function l(e){let t=Math.floor(e/6e4),n=Math.floor(e%6e4/100)/10;return 0===t?"".concat(n.toString(),"s"):"".concat(t,"min ").concat(n.toString(),"s")}n.d(t,{Wo:()=>r,fU:()=>l,tI:()=>i})},17222:(e,t,n)=>{"use strict";n.d(t,{U0:()=>l,Xg:()=>r,ce:()=>o,ho:()=>c});var s=n(30709),a=n(1883);let r=["default","professional","empathetic","direct"],i=a.k5(r);function l(e){let t=(0,s.M)(0,3);for(;t===e;)t=(0,s.M)(0,3);return t}a.Ik({type:a.eu("preset"),preset:i});let o={formality:["polite","casual"],empathy:["empathetic","objective"],energy:["motivational","reflective"],communication:["direct","gentle"],seriousness:["humorous","earnest"],verbosity:["concise","detailed"],maturity:["young","mature"],expression:["pragmatic","poetic"]},c=Object.values(o).flat(),d=a.Ik({formality:a.k5(o.formality).nullable(),empathy:a.k5(o.empathy).nullable(),energy:a.k5(o.energy).nullable(),communication:a.k5(o.communication).nullable(),seriousness:a.k5(o.seriousness).nullable(),verbosity:a.k5(o.verbosity).nullable(),maturity:a.k5(o.maturity).nullable(),expression:a.k5(o.expression).nullable()});a.Ik({type:a.eu("tone"),tone:d}),a.Ik({type:a.eu("custom"),instructions:a.Yj()})},17800:(e,t,n)=>{"use strict";n.d(t,{b:()=>l});var s=n(93706),a=n(63123),r=n(8424),i=n(35111);function l(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,s.c3)("Projects.create"),n=i.api.useUtils();return i.api.project.create.useMutation({...e,onMutate:async function(){for(var t,s=arguments.length,r=Array(s),i=0;i<s;i++)r[i]=arguments[i];let[{name:l,icon:o}]=r,c=(0,a.A)();return n.project.list.cancel(),n.project.list.setData(void 0,e=>[...null!=e?e:[],{id:c,name:l,icon:null!=o?o:null,chatCount:0,createdAt:new Date,updatedAt:new Date,libraryId:null}]),await (null==(t=e.onMutate)?void 0:t.call(e,...r)),{id:c}},onSuccess:async function(){for(var t,s=arguments.length,a=Array(s),r=0;r<s;r++)a[r]=arguments[r];let[i,,{id:l}]=a;await n.project.list.cancel(),n.project.list.setData(void 0,e=>null==e?void 0:e.map(e=>e.id===l?{...i,chatCount:0}:e)),null==(t=e.onSuccess)||t.call(e,...a)},onError:function(){for(var s,a=arguments.length,i=Array(a),l=0;l<a;l++)i[l]=arguments[l];r.oRP.error(t("mutation_error_toast")),n.project.list.invalidate(),null==(s=e.onError)||s.call(e,...i)}})}},18019:(e,t,n)=>{"use strict";function s(e){var t;return null==(t=/\/chat\/([a-f0-9-]+)$/.exec(e.getData("text/plain")))?void 0:t.at(1)}n.d(t,{J:()=>s})},21104:(e,t,n)=>{"use strict";n.d(t,{DB:()=>c,yY:()=>d});var s=n(33152),a=n(8672),r=n(51039);let i=["!",".","?","։","؟","۔","܀","܁","܂","߹","।","॥","၊","။","።","፧","፨","᙮","᜵","᜶","᠃","᠉","᥄","᥅","᪨","᪩","᪪","᪫","᭚","᭛","᭞","᭟","᰻","᰼","᱾","᱿","‼","‽","⁇","⁈","⁉","⸮","⸼","꓿","꘎","꘏","꛳","꛷","꡶","꡷","꣎","꣏","꤯","꧈","꧉","꩝","꩞","꩟","꫰","꫱","꯫","﹒","﹖","﹗","！","．","？","\uD802\uDE56","\uD802\uDE57","\uD804\uDC47","\uD804\uDC48","\uD804\uDCBE","\uD804\uDCBF","\uD804\uDCC0","\uD804\uDCC1","\uD804\uDD41","\uD804\uDD42","\uD804\uDD43","\uD804\uDDC5","\uD804\uDDC6","\uD804\uDDCD","\uD804\uDDDE","\uD804\uDDDF","\uD804\uDE38","\uD804\uDE39","\uD804\uDE3B","\uD804\uDE3C","\uD804\uDEA9","\uD805\uDC4B","\uD805\uDC4C","\uD805\uDDC2","\uD805\uDDC3","\uD805\uDDC9","\uD805\uDDCA","\uD805\uDDCB","\uD805\uDDCC","\uD805\uDDCD","\uD805\uDDCE","\uD805\uDDCF","\uD805\uDDD0","\uD805\uDDD1","\uD805\uDDD2","\uD805\uDDD3","\uD805\uDDD4","\uD805\uDDD5","\uD805\uDDD6","\uD805\uDDD7","\uD805\uDE41","\uD805\uDE42","\uD805\uDF3C","\uD805\uDF3D","\uD805\uDF3E","\uD806\uDE42","\uD806\uDE43","\uD806\uDE9B","\uD806\uDE9C","\uD807\uDC41","\uD807\uDC42","\uD81A\uDE6E","\uD81A\uDE6F","\uD81A\uDEF5","\uD81A\uDF37","\uD81A\uDF38","\uD81A\uDF44","\uD82F\uDC9F","\uD836\uDE88","｡","。"];function l(e,t){var n,s,a;let r=function(e){let t=i.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|");return e.split(new RegExp("(".concat(t,")")))}(e),l=[],o=0;for(;o<r.length;){let e=r[o];if(!(null==e?void 0:e.trim())||i.includes(e)){o+=1;continue}let s=e,a=s.split(/\s+/).filter(e=>e.trim()).length;if(o+1<r.length&&i.includes(r[o+1])&&(s+=r[o+1],o+=1),a<=t){for(let e=0;e<l.length;e++){let[r,i]=null!=(n=l[e])?n:[];if(!r||!i)throw Error("Error while processing reference extract : empty span / length element.");a+i<=t&&(l[e]=[r+s,i+a])}l.push([s,a])}else{let e=function(e,t){let n=e.split(/(\s+)/),s="",a=0;for(let e of n)if(e.trim()&&(a+=1),s+=e,a>=t)break;return s}(s,t);l.push([e,t])}o+=1}for(let e=l.length-1;e>0;e--){let t=e-1,[n]=null!=(s=l[e])?s:[],[r]=null!=(a=l[t])?a:[];if(!n||!r)throw Error("Error while processing reference extract : empty span pair.");if(r.includes(n)){l.splice(e,1);continue}}return l.map(e=>{let[t]=e;return t.trim()})}async function o(e,t){let[n]=await (0,s.v7)(e,t,{processor:e=>e.trim().toLowerCase(),limit:1});if(!n)throw Error("Error while processing reference extract : empty fuzzball extract.");return{textChoice:n[0],score:n[1],extractIndex:n[2]}}let c=async(e,t,n)=>{if(!e||(0,a.u)(n)||e.source===r.ip)return{text:""};if(e.snippets&&e.snippets.length>0)try{let s=t[n];if(void 0===s)return{text:e.snippets.join(" ")};let a=function(e,t){let n=e.snippets;if(!n)return[];let s=function(e){e.sort((e,t)=>t.length-e.length);let t=[];for(let n of e){let e=!1;for(let s of t)if(s.includes(n)){e=!0;break}e||t.push(n)}return t}(n);if(!s.length)return[];let a=[];for(let e of s)a.push(...l(e,80));return[...new Set(a)]}(e,0),r=await o(s,a);return{text:r.textChoice,hasPreviousContent:a.length>1&&r.extractIndex>0,hasNextContent:a.length>1&&r.extractIndex<a.length-1}}catch(t){return{text:e.snippets.join(" ")}}if(e.content)try{let s=t[n];if(void 0!==s){let t=l(e.content,80),n=await o(s,t);return{text:n.textChoice,hasPreviousContent:t.length>1&&n.extractIndex>0,hasNextContent:t.length>1&&n.extractIndex<t.length-1}}}catch(e){}return e.description?{text:e.description}:{text:""}};function d(e,t){let n,s={};return t&&e?(e.forEach((e,t)=>{"text"===e.type&&e.text.length>0?n=e.text.slice(-80):"reference"===e.type?s[t]=n:n=void 0}),s):s}},24999:(e,t,n)=>{"use strict";n.d(t,{$P:()=>s,ZK:()=>r,lj:()=>a});let s=(e,t)=>({...e,items:e.items.filter(e=>!t(e))}),a=(e,t,n)=>({pageParams:e.pageParams,pages:e.pages.map(e=>({...e,items:e.items.map(e=>t(e)?n(e):e)}))}),r=(e,t)=>({pageParams:e.pageParams,pages:e.pages.map(e=>({...e,items:e.items.filter(e=>!t(e))}))})},28288:(e,t,n)=>{"use strict";n.d(t,{p:()=>a});var s=n(88049);function a(e,t){let n=t.length-e.length;if(1===n){let[n,...a]=t;return(0,s.F)(n,{lazy:e,lazyArgs:a})}if(0===n){let n={lazy:e,lazyArgs:t};return Object.assign(e=>(0,s.F)(e,n),n)}throw Error("Wrong number of arguments")}},30709:(e,t,n)=>{"use strict";function s(e,t){let n=Math.ceil(e),s=Math.floor(t);if(s<n)throw RangeError(`randomInteger: The range [${e.toString()},${t.toString()}] contains no integer`);return Math.floor(Math.random()*(s-n+1)+n)}n.d(t,{M:()=>s})},34435:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});let s=(0,n(73415).vt)(e=>({open:!1,setOpen:t=>{e({open:t})}}))},38163:(e,t,n)=>{"use strict";n.d(t,{HelpHubButton:()=>i});var s=n(64784),a=n(93706),r=n(8424);let i=e=>{let{children:t,className:n,showIntercom:i}=e,l=(0,a.c3)("General.help_hub");return(0,s.jsx)(r.fTe.HelpHub,{className:n,labels:{title:l("title"),section_documentation:l("labels.section_documentation"),link_api_documentation:l("labels.link_api_documentation"),link_documentation:l("labels.link_documentation"),link_help_center:l("labels.link_help_center"),section_contact:l("labels.section_contact"),link_discord:l("labels.link_discord"),link_intercom:l("labels.link_intercom"),section_terms_and_privacy:l("labels.section_terms_and_privacy"),link_terms_of_service:l("labels.link_terms_of_service"),link_privacy_policy:l("labels.link_privacy_policy")},sections:i?r.fTe.helpHubSections:r.fTe.helpHubSections.map(e=>"section_contact"===e.key?{...e,links:e.links.filter(e=>"link_intercom"!==e.key)}:e),handlers:{open_intercom:()=>{var e,t;null==(e=(t=window).Intercom)||e.call(t,"show")}},children:t})}},39343:(e,t,n)=>{"use strict";n.d(t,{GR:()=>c,LT:()=>u,dX:()=>l,kD:()=>i,t3:()=>r});var s=n(74032),a=n(6790);let r=(e,t)=>{if(null===t||!e)return{};let n=(0,s.p)(e,e=>e.id.toString()),a=n.findIndex(e=>e.id.toString()===t.toString()),r=n[a];return r?{reference:r,refIndex:a}:{}};function i(e){let{contentChunkIndex:t,referenceIds:n}=e;return":".concat("refs","[").concat(t,"-").concat(n.join(","),"]")}function l(e){let[t,n]=e.split("-"),s=Number(t),a=null==n?void 0:n.split(",");return a&&s?{contentChunkIndex:s,referenceIds:a}:null}function o(e){return null===e?"":e.replace(/[&<>'"|]/g,e=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;","|":"&verbar;"})[e]||e)}function c(e){return":".concat("tool_references","[references]{").concat(e.flatMap((e,t)=>{let{description:n,favicon:s,title:a,url:r}=e;return["ref_".concat(t,"_url='").concat(o(r),"'"),"ref_".concat(t,"_title='").concat(o(a),"'"),"ref_".concat(t,"_favicon='").concat(o(s),"'"),"ref_".concat(t,"_description='").concat(o(n),"'")]}).join(" "),"}")}let d=RegExp("ref_(?<referenceIndex>\\d+)_(?<data>url|title|favicon|description)");function u(e){let t=[];return(0,a.u)(e,(e,n)=>{var s;let a=null==(s=d.exec(n))?void 0:s.groups;if(!a)return;let r=Number(a.referenceIndex);void 0===t[r]&&(t[r]={}),t[r][a.data]=e}),t}},42524:(e,t,n)=>{"use strict";function s(){return a}n.d(t,{D:()=>s});let a=e=>e},44233:(e,t,n)=>{"use strict";n.d(t,{j4:()=>s,zd:()=>a});let s=e=>{let{stepId:t,isDone:n=!1}=e;return{name:"deep_research_summarize",toolType:"raw",type:"tool_call",isInterrupted:!1,isDone:n,publicArguments:null,id:"".concat(t,"_summarize"),turn:0,requiresConfirmation:!1,confirmationStatus:void 0}};function a(e){if(!e)return null;try{let{hostname:t}=new URL(e);return t.startsWith("www.")?t.slice(4):t}catch(e){return null}}},48604:(e,t,n)=>{"use strict";n.d(t,{a:()=>c});var s=n(64784),a=n(93706),r=n(52907),i=n(8424),l=n(75429),o=n(99463);function c(){let e=(0,a.c3)("Billing.upgrade");return(0,s.jsxs)(i.Cff,{hideX:!0,className:"sm:w-sm",children:[(0,s.jsx)(o.e,{}),(0,s.jsx)(i.L33,{children:e("title")}),(0,s.jsx)("p",{className:"text-muted",children:e("description")}),(0,s.jsxs)(i.Esm,{className:"grid grid-cols-1 sm:grid-cols-2",children:[(0,s.jsx)(i.HMX,{asChild:!0,children:(0,s.jsx)(l.$n,{variant:"secondary",children:e("ctas.cancel")})}),(0,s.jsx)(r.v,{href:"/upgrade",children:e("ctas.upgrade")})]})]})}},48937:(e,t,n)=>{Promise.resolve().then(n.bind(n,95027)),Promise.resolve().then(n.bind(n,23964)),Promise.resolve().then(n.bind(n,38163)),Promise.resolve().then(n.bind(n,15541)),Promise.resolve().then(n.bind(n,97435)),Promise.resolve().then(n.bind(n,10834)),Promise.resolve().then(n.bind(n,35111)),Promise.resolve().then(n.bind(n,63100)),Promise.resolve().then(n.bind(n,42864)),Promise.resolve().then(n.bind(n,5291)),Promise.resolve().then(n.bind(n,78995)),Promise.resolve().then(n.bind(n,55433)),Promise.resolve().then(n.bind(n,22620)),Promise.resolve().then(n.bind(n,41896)),Promise.resolve().then(n.bind(n,22412)),Promise.resolve().then(n.bind(n,79653)),Promise.resolve().then(n.bind(n,89928)),Promise.resolve().then(n.bind(n,11025)),Promise.resolve().then(n.bind(n,24180)),Promise.resolve().then(n.bind(n,90852)),Promise.resolve().then(n.bind(n,26752)),Promise.resolve().then(n.bind(n,35608)),Promise.resolve().then(n.bind(n,95131)),Promise.resolve().then(n.t.bind(n,63929,23)),Promise.resolve().then(n.bind(n,77410)),Promise.resolve().then(n.bind(n,73519)),Promise.resolve().then(n.bind(n,6343)),Promise.resolve().then(n.bind(n,77734)),Promise.resolve().then(n.bind(n,93736)),Promise.resolve().then(n.bind(n,19970)),Promise.resolve().then(n.bind(n,92855)),Promise.resolve().then(n.bind(n,73599)),Promise.resolve().then(n.bind(n,66947)),Promise.resolve().then(n.bind(n,41549)),Promise.resolve().then(n.bind(n,54628)),Promise.resolve().then(n.bind(n,26297)),Promise.resolve().then(n.bind(n,68631)),Promise.resolve().then(n.bind(n,13555)),Promise.resolve().then(n.bind(n,5591)),Promise.resolve().then(n.bind(n,79935)),Promise.resolve().then(n.bind(n,19497)),Promise.resolve().then(n.bind(n,67332)),Promise.resolve().then(n.bind(n,83834)),Promise.resolve().then(n.bind(n,11595)),Promise.resolve().then(n.bind(n,53193)),Promise.resolve().then(n.bind(n,53785)),Promise.resolve().then(n.bind(n,45579)),Promise.resolve().then(n.bind(n,25028)),Promise.resolve().then(n.bind(n,51943)),Promise.resolve().then(n.bind(n,89328)),Promise.resolve().then(n.bind(n,23135)),Promise.resolve().then(n.bind(n,30671)),Promise.resolve().then(n.bind(n,57964)),Promise.resolve().then(n.bind(n,71721)),Promise.resolve().then(n.bind(n,66576)),Promise.resolve().then(n.bind(n,33006)),Promise.resolve().then(n.bind(n,887)),Promise.resolve().then(n.bind(n,49972)),Promise.resolve().then(n.bind(n,40736)),Promise.resolve().then(n.bind(n,9301)),Promise.resolve().then(n.bind(n,80232)),Promise.resolve().then(n.bind(n,50825)),Promise.resolve().then(n.bind(n,53393)),Promise.resolve().then(n.bind(n,65104)),Promise.resolve().then(n.bind(n,74133)),Promise.resolve().then(n.bind(n,77394)),Promise.resolve().then(n.bind(n,26056)),Promise.resolve().then(n.bind(n,96174)),Promise.resolve().then(n.bind(n,17027)),Promise.resolve().then(n.bind(n,81920)),Promise.resolve().then(n.bind(n,71680)),Promise.resolve().then(n.bind(n,57030)),Promise.resolve().then(n.bind(n,79665)),Promise.resolve().then(n.bind(n,95978)),Promise.resolve().then(n.bind(n,51205)),Promise.resolve().then(n.bind(n,3335)),Promise.resolve().then(n.bind(n,4606)),Promise.resolve().then(n.bind(n,21982)),Promise.resolve().then(n.bind(n,78242)),Promise.resolve().then(n.bind(n,76734)),Promise.resolve().then(n.bind(n,90046)),Promise.resolve().then(n.bind(n,43583)),Promise.resolve().then(n.bind(n,66212)),Promise.resolve().then(n.bind(n,24060)),Promise.resolve().then(n.bind(n,41176)),Promise.resolve().then(n.bind(n,58604)),Promise.resolve().then(n.bind(n,53967)),Promise.resolve().then(n.bind(n,18799)),Promise.resolve().then(n.bind(n,20869)),Promise.resolve().then(n.bind(n,96841)),Promise.resolve().then(n.bind(n,3963)),Promise.resolve().then(n.bind(n,17687)),Promise.resolve().then(n.bind(n,5439)),Promise.resolve().then(n.bind(n,14673)),Promise.resolve().then(n.bind(n,1613))},55796:(e,t,n)=>{"use strict";n.d(t,{m:()=>o});var s=n(64784),a=n(6016),r=n(79497),i=n(30063);let l={1:{src:"/_next/static/media/1.9317b3e3.svg",height:86,width:86,blurWidth:0,blurHeight:0},2:{src:"/_next/static/media/2.842f3bcc.svg",height:86,width:86,blurWidth:0,blurHeight:0},3:{src:"/_next/static/media/3.4325f66c.svg",height:86,width:86,blurWidth:0,blurHeight:0},4:{src:"/_next/static/media/4.5b8e2103.svg",height:86,width:86,blurWidth:0,blurHeight:0},5:{src:"/_next/static/media/5.a3f2176b.svg",height:86,width:86,blurWidth:0,blurHeight:0},6:{src:"/_next/static/media/6.86700681.svg",height:86,width:86,blurWidth:0,blurHeight:0},7:{src:"/_next/static/media/7.5878fc8b.svg",height:86,width:86,blurWidth:0,blurHeight:0},8:{src:"/_next/static/media/8.efa65138.svg",height:86,width:86,blurWidth:0,blurHeight:0},9:{src:"/_next/static/media/9.8e145799.svg",height:86,width:86,blurWidth:0,blurHeight:0},10:{src:"/_next/static/media/10.99e5538b.svg",height:86,width:86,blurWidth:0,blurHeight:0},11:{src:"/_next/static/media/11.8af91e78.svg",height:86,width:86,blurWidth:0,blurHeight:0},12:{src:"/_next/static/media/12.c8ca6605.svg",height:86,width:86,blurWidth:0,blurHeight:0},13:{src:"/_next/static/media/13.542eeb77.svg",height:86,width:86,blurWidth:0,blurHeight:0},14:{src:"/_next/static/media/14.0a1aaa4e.svg",height:86,width:86,blurWidth:0,blurHeight:0},15:{src:"/_next/static/media/15.6700a365.svg",height:86,width:86,blurWidth:0,blurHeight:0},16:{src:"/_next/static/media/16.bc73ff58.svg",height:86,width:86,blurWidth:0,blurHeight:0},17:{src:"/_next/static/media/17.8921679c.svg",height:86,width:86,blurWidth:0,blurHeight:0},18:{src:"/_next/static/media/18.b3f5d58f.svg",height:86,width:86,blurWidth:0,blurHeight:0},19:{src:"/_next/static/media/19.eba09578.svg",height:86,width:86,blurWidth:0,blurHeight:0},20:{src:"/_next/static/media/20.8eaaf57b.svg",height:86,width:86,blurWidth:0,blurHeight:0},21:{src:"/_next/static/media/21.ce3efc6c.svg",height:86,width:86,blurWidth:0,blurHeight:0}};function o(e){let{size:t,animation:n,className:o,brandAvatarId:c}=e;return(0,s.jsx)(a.P.div,{..."entry"===n?{initial:{opacity:0,y:8},animate:{opacity:1,y:0}}:"hovering"===n?{initial:{y:-1},animate:{y:1},transition:{repeat:1/0,repeatType:"reverse",ease:"easeInOut",duration:.75}}:{},children:(0,s.jsx)(r.default,{width:t,height:t,className:(0,i.cn)(o,"scale-[1.8] object-cover object-center"),src:c in l?l[c]:l[1],alt:"Brand Avatar ".concat(c),style:{imageRendering:"pixelated"}})})}},59888:(e,t,n)=>{"use strict";n.d(t,{X:()=>a});var s=n(47097);function a(...e){return(0,s.T)(r,e)}function r(e,t){if(t<=0)return[];if(t>=e.length)return[...e];let n=Math.min(t,e.length-t),s=new Set;for(;s.size<n;){let t=Math.floor(Math.random()*e.length);s.add(t)}return t===n?[...s].sort((e,t)=>e-t).map(t=>e[t]):e.filter((e,t)=>!s.has(t))}},62044:(e,t,n)=>{"use strict";n.d(t,{$3:()=>l,We:()=>i,sZ:()=>r});var s=n(73415),a=n(61639);let r=(0,s.vt)()((0,a.Zr)((e,t)=>({customEngineConfig:null,setCustomEngineConfig:t=>e({customEngineConfig:t}),deleteCustomEngineConfig:()=>e({customEngineConfig:null})}),{name:"debug-custom-engine-config"})),i=(0,s.vt)()((0,a.Zr)(e=>({endpoint:void 0,setEndpoint:t=>e({endpoint:t})}),{name:"debug-custom-completion-endpoint"})),l=(0,s.vt)()((0,a.Zr)(e=>({parameters:{},setParameters:t=>e({parameters:t}),deleteParameters:()=>e({parameters:{}})}),{name:"debug-custom-parameters"}))},68084:(e,t,n)=>{"use strict";n.d(t,{q:()=>r});var s=n(12330),a=n(8380);function r(){let e=(0,s.usePathname)();return(0,a.useMemo)(()=>{let[t,n,s]=e.split("/");return"chat"===n&&s?s:null},[e])}},71222:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var s=n(47097);function a(...e){return(0,s.T)(function e(t,n){if(t===n||Object.is(t,n))return!0;if("object"!=typeof t||"object"!=typeof n||null===t||null===n||Object.getPrototypeOf(t)!==Object.getPrototypeOf(n))return!1;if(Array.isArray(t)){var s=t,a=n;if(s.length!==a.length)return!1;for(let[t,n]of s.entries())if(!e(n,a[t]))return!1;return!0}if(t instanceof Map){var r=t,i=n;if(r.size!==i.size)return!1;for(let[t,n]of r.entries())if(!i.has(t)||!e(n,i.get(t)))return!1;return!0}if(t instanceof Set){var l=t,o=n;if(l.size!==o.size)return!1;let s=[...o];for(let t of l){let n=!1;for(let[a,r]of s.entries())if(e(t,r)){n=!0,s.splice(a,1);break}if(!n)return!1}return!0}if(t instanceof Date)return t.getTime()===n.getTime();if(t instanceof RegExp)return t.toString()===n.toString();if(Object.keys(t).length!==Object.keys(n).length)return!1;for(let[s,a]of Object.entries(t))if(!(s in n)||!e(a,n[s]))return!1;return!0},e)}},74789:(e,t,n)=>{"use strict";n.d(t,{J:()=>a});var s=n(69957);let a={chatVisibility:s.j.PRIVATE,chatPermission:s.J.WRITE}},77624:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d,_:()=>c});var s=n(6807),a=n(42573),r=n(78611),i=n(97561),l=n(35111),o=n(74789);let c={chatVisibility:i.jZ.PRIVATE,chatPermission:i.Jj.WRITE,pinned:!0,limit:r.C0,includeProjectChats:!1};function d(e){var t;let n=l.api.useUtils(),i=(0,a.DE)(),d=null==(t=n.chat.last.getData(c))?void 0:t.items.length;return{canPinChat:!!i&&(0,s.h)(d)&&d<r.C0,mutation:l.api.chat.setPinned.useMutation({onMutate(e){n.chat.byId.setData({id:e.chatId},t=>t&&{...t,pinned:e.pinned})},onSettled(t,s,a){var r,i;n.chat.last.invalidate(o.J),n.chat.last.invalidate(c),n.chat.byId.invalidate({id:a.chatId});let l=null!=(i=null==e?void 0:e.projectId)?i:null==(r=n.chat.byId.getData({id:a.chatId}))?void 0:r.projectId;l&&n.project.byId.invalidate({id:l})}})}}},78611:(e,t,n)=>{"use strict";n.d(t,{C0:()=>s,RN:()=>i,yk:()=>u,zd:()=>h.zd});let s=1e3;var a=n(82343),r=n(59888);let i=["#f4f4f5","#6d727f","#14171e","#bb5d02","#ff2b26","#fa500f","#ffaf00","#ffd700","#cddc1e","#58dc06","#44ba82","#44b8a7","#00c8e6","#1e9eff","#37a3ee","#006aff","#6060f8","#8655fd","#b667e5","#f83cb3","#eb3e5b"],l={NEUTRAL:[["#ff6b6b",1],["#ffd93d",1],["#6bcb77",1],["#4d96ff",1]],MAGENTA:[["#fbd6d2",1],["#f190b7",.5],["#ce49bf",.2],["#a63ec5",.1]],MAGENTA_SEPIA:[["#46244c",1],["#712b75",.5],["#c74b50",.2],["#d49b54",.1]],LIGHT_GREEN:[["#97dbae",1],["#c3e5ae",.5],["#f1e1a6",.2],["#f4bbbb",.1]],SEPIA:[["#f4fcd9",1],["#c5d8a4",.5],["#bb9981",.2],["#534340",.2]],MAGMA:[["#630606",1],["#890f0d",1],["#e83a14",.5],["#d9ce3f",.2]],ICE:[["#effffd",1],["#b8fff9",.7],["#85f4ff",.4],["#42c2ff",.1]],DARK_SEPIA:[["#1c0a00",1],["#361500",.8],["#603601",.5],["#cc9544",.3]],SOLARIZE:[["#ffd32d",1],["#008e89",1],["#085e7d",1],["#084594",1]],DARKULA:[["#041c32",1],["#04293a",1],["#064663",1],["#ecb365",.2]],BLUE:[["#051367",1],["#2d31fa",.5],["#5d8bf4",.2],["#dff6ff",.1]],RETROWAVE:[["#1a1a40",1],["#270082",1],["#7a0bc0",.5],["#fa58b6",.2]],BLOOD:[["#3d0000",1],["#950101",1],["#ff0000",.5]],PURPUR:[["#420516",1],["#7d1935",1],["#b42b51",.5],["#e63e6d",.5]],GRAYSCALE_MAGENTA:[["#f3f1f5",1],["#f0d9ff",1],["#bfa2db",1],["#7f7c82",.2]],NIGHT_SKY:[["#261c2c",1],["#3e2c41",1],["#5c527f",.7],["#6e85b2",.5]],SUNSET:[["#faad80",1],["#ff6767",.6],["#ff3d68",.3],["#a73489",.2]],TOXIC_LIME:[["#1fab89",1],["#62d2a2",1],["#9df3c4",1],["#d7fbe8",1]],SKY:[["#7c83fd",1],["#96baff",1],["#7dedff",.3],["#88fff7",.3]],BROWNSCALE:[["#362222",1],["#171010",1],["#423f3e",.6],["#2b2b2b",.6]],LIGHT_SEPIA:[["#fef7dc",1],["#e6ddc6",1],["#c2b8a3",.8],["#a19882",.5]],SUN:[["#f7fd04",.2],["#f9b208",1],["#f98404",.6],["#fc5404",.4]],PURPLE_SOLARIZED:[["#f39189",1],["#bb8082",1],["#6e7582",.4],["#046582",.2]],CYBERPUNK:[["#00bdaa",1],["#400082",1],["#fe346e",1],["#f1e7b6",1]],DIAMOND_BLACK:[["#212121",1],["#323232",1],["#0d7377",.2],["#14ffec",.2]],CYBER_BLACK:[["#08d9d6",.2],["#252a34",1],["#ff2e63",.2],["#eaeaea",.2]],DIAMOND:[["#defcf9",1],["#cadefc",.5],["#c3bef0",.3],["#cca8e9",.2]],BLOOD_MOON:[["#2b2e4a",1],["#e84545",.1],["#903749",.3],["#53354a",.5]],GERMANY:[["#143f6b",1],["#f55353",1],["#feb139",1],["#f6f54d",.5]],GOLD_ORE:[["#343434",1],["#e6b31e",.4],["#fcfaf1",.3],["#cacaca",.5]],LAVA_POOL:[["#082032",1],["#2c394b",1],["#334756",1],["#ff4c29",.5]],CREAM:[["#ffdede",.6],["#fdf5ca",1],["#ffdfaf",1],["#f2bb7b",1]]},o=e=>{var t;let n=e.map(e=>{var t;return null!=(t=e[1])?t:0});for(let s=0;s<e.length;s++)n[s]+=null!=(t=n[s-1])?t:0;let s=Math.random()*n[n.length-1];for(let t=0;t<n.length;t++)if(n[t]>s)return e[t];return e[Math.random()*e.length|0]},c=(e,t,n)=>{switch(e){case"HORIZONTAL":if(n)return[...t,...t.reverse().slice(1)];return[...t,...t.reverse()];case"VERTICAL":if(n)return t.map(e=>[...e.slice(1).reverse(),...e]);return t.map(e=>[...e.slice().reverse(),...e]);case"QUAD":return c("HORIZONTAL",c("VERTICAL",t,n),n)}},d=function(e,t,n,s){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,r=arguments.length>5?arguments[5]:void 0,i=[e,t];switch(n){case"HORIZONTAL":i=[i[0],i[1]/2];break;case"VERTICAL":i=[i[0]/2,i[1]];break;case"QUAD":i=[i[0]/2,i[1]/2]}return c(n,((e,t,n,s,a)=>{let r=[];for(let l=0;l<t;l++){r[l]=[];for(let t=0;t<e;t++)if(Math.random()<s){var i;r[l][t]=null!=(i=null==a?void 0:a[0])?i:o(n)[0]}else r[l][t]=null}return r})(i[0],i[1],s,a,r),!!i.find(e=>!Number.isInteger(e)))};function u(e){var t,n,s,o;let c=null!=(t=null==e?void 0:e.colorScheme)?t:(0,a.$)((0,r.X)(Object.values(l),1)),u=null!=(n=null==e?void 0:e.size)?n:8;return{pixels:d(u,u,null!=(s=null==e?void 0:e.symmetry)?s:"VERTICAL",c,null!=(o=null==e?void 0:e.fillFactor)?o:.5,null==e?void 0:e.color),backgroundColor:(0,r.X)(i,1)[0]}}var h=n(44233)},82343:(e,t,n)=>{"use strict";n.d(t,{$:()=>a});var s=n(47097);function a(...e){return(0,s.T)(r,e,Object.assign(i,{single:!0}))}let r=([e])=>e,i=()=>l,l=e=>({hasNext:!0,next:e,done:!0})},84544:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var s=n(64784),a=n(47765),r=n(21917),i=n(79497),l=n(93706),o=n(8424);function c(e){let{nbLines:t=5}=e;return(0,s.jsxs)("div",{className:"flex w-full flex-col items-start space-y-4",children:[t&&Array.from({length:t-1}).map((e,t)=>(0,s.jsx)(o.EAD,{className:"h-5 w-full"},t)),(0,s.jsx)(o.EAD,{className:"h-5 w-2/3"})]})}var d=n(57743),u=n(17210);function h(e){let{errorCode:t}=e,n=(0,l.c3)("Chat"),i="TOO_MANY_REQUESTS"===t?"rateLimitReached":"default",c="TOO_MANY_REQUESTS"===t?a.A:r.A;return(0,s.jsx)(o.FcD,{children:(0,s.jsx)("div",{className:"flex w-full flex-row items-start gap-4",children:(0,s.jsxs)("div",{className:"flex w-full flex-col",children:[(0,s.jsxs)("div",{className:"flex w-full flex-row gap-2",children:[(0,s.jsx)(c,{className:"h-4 min-h-4 w-4 min-w-4"}),(0,s.jsx)(o.XL1,{children:n("afp_reference_dialog.errors.".concat(i,".title"))})]}),(0,s.jsx)(o.TND,{className:"ps-6 whitespace-break-spaces text-muted",children:n("afp_reference_dialog.errors.".concat(i,".description"))})]})})})}function m(e){var t,n,a;let{article:r,handleDialogOpenChange:m,isOpen:p}=e,x=(0,l.c3)("Chat");return(0,s.jsx)(o.lGe,{open:p,onOpenChange:m,children:(0,s.jsxs)(o.Cff,{className:"w-3xl max-w-3xl overflow-hidden px-4 select-none sm:px-9",children:[(0,s.jsx)(o.c75,{className:"justify-between py-1",children:(0,s.jsxs)("div",{className:"flex flex-row",children:[(0,s.jsx)(i.default,{src:d.A,alt:"favicon",className:"me-4 max-h-[50px] shrink-0 items-center rounded-full",width:50,height:50}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)(o.L33,{className:"line-clamp-2 text-lg font-semibold text-default",children:null==r?void 0:r.title}),(0,s.jsx)(o.rrK,{className:"pt-2 whitespace-break-spaces",children:"".concat(x("afp_reference_dialog.published_date")).concat((null==r?void 0:r.date)?(0,u.Wo)(new Date(r.date),{format:"short",yesterdayTranslation:x("left_panel.yesterday")}):"")})]})]})}),(0,s.jsxs)(o.FKN,{className:"relative -me-3 h-96 pe-5",children:[(null==r||null==(t=r.status)?void 0:t.name)==="loaded"&&(0,s.jsx)("div",{className:"article-content",dangerouslySetInnerHTML:{__html:r.html||""}}),(null==r||null==(n=r.status)?void 0:n.name)==="loading"&&(0,s.jsx)(c,{nbLines:8}),(null==r||null==(a=r.status)?void 0:a.name)==="error"&&(0,s.jsx)(h,{errorCode:r.status.code}),(0,s.jsx)(o.$H1,{dir:"vertical"}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-1 bg-linear-to-b from-default to-transparent"}),(0,s.jsx)("div",{className:"pointer-events-none absolute inset-x-0 bottom-0 h-4 bg-linear-to-t from-default to-transparent"})]})]})})}},87985:(e,t,n)=>{"use strict";n.d(t,{F:()=>i});var s=n(6152),a=n(9243),r=n(96904);let i=[{Icon:s.A,theme:"light",labelKey:"user_nav.switch_theme_light"},{Icon:a.A,theme:"dark",labelKey:"user_nav.switch_theme_dark"},{Icon:r.A,theme:"system",labelKey:"user_nav.switch_theme_system"}]},88049:(e,t,n)=>{"use strict";n.d(t,{F:()=>a});var s=n(95183);function a(e,...t){let n=e,r=t.map(e=>"lazy"in e?function(e){let{lazy:t,lazyArgs:n}=e;return Object.assign(t(...n),{isSingle:t.single??!1,index:0,items:[]})}(e):void 0),i=0;for(;i<t.length;){var l;if(void 0===r[i]||!("string"==typeof(l=n)||"object"==typeof l&&l&&Symbol.iterator in l)){n=(0,t[i])(n),i+=1;continue}let e=[];for(let n=i;n<t.length;n++){let t=r[n];if(void 0===t||(e.push(t),t.isSingle))break}let a=[];for(let t of n)if(function e(t,n,a){if(0===a.length)return n.push(t),!1;let r=t,i=s.Qj,l=!1;for(let[t,s]of a.entries()){let{index:o,items:c}=s;if(c.push(r),i=s(r,o,c),s.index+=1,i.hasNext){if(i.hasMany){for(let s of i.next)if(e(s,n,a.slice(t+1)))return!0;return l}r=i.next}if(!i.hasNext)break;i.done&&(l=!0)}return i.hasNext&&n.push(r),l}(t,a,e))break;let{isSingle:o}=e.at(-1);n=o?a[0]:a,i+=e.length}return n}},92708:(e,t,n)=>{"use strict";n.d(t,{v:()=>i});var s=n(76641),a=n(83125);let r="Le Chat",i=e=>{let{t,leChatPlan:n,orgTier:i}=e;switch(n){case s._C.INDIVIDUAL:case s._C.EDU:return"".concat(r," ").concat(t("plans.individual.name"));case s._C.TEAM:return i===a.el.ENTERPRISE?"".concat(r," ").concat(t("tiers.enterprise.name")):"".concat(r," ").concat(t("plans.teams.name"));default:return"".concat(r," ").concat(t("plans.free.name"))}}},93699:(e,t,n)=>{"use strict";n.d(t,{l:()=>g});var s=n(64784),a=n(13166),r=n(64618),i=n(93706),l=n(82248),o=n(1883),c=n(8424),d=n(75429),u=n(44892),h=n(31991),m=n(801),p=n(17800);let x=o.Ik({name:o.Yj().min(1)});function f(e){let{onCreateSuccess:t}=e,n=(0,i.c3)(),{mutateAsync:o}=(0,p.b)({onSuccess:e=>{f.reset(),t({...e,chatCount:0})}}),f=(0,l.mN)({resolver:(0,a.u)(x)}),g=f.handleSubmit(e=>{let{name:t}=e;return o({name:t})},()=>c.oRP.error(n("Projects.create.validation_error_toast")));return(0,s.jsxs)(h.lV,{form:f,id:"create-project",onSubmit:g,style:{all:"inherit"},children:[(0,s.jsx)(c.c75,{children:(0,s.jsxs)(c.L33,{className:"flex items-center",children:[(0,s.jsx)(r.A,{className:"size-8 rounded-sm bg-state-soft p-1.5 text-subtle"}),(0,s.jsx)(m.pd,{...f.register("name"),type:"text",variant:"unstyled",autoFocus:!0,placeholder:n("Chat.left_panel.create_project"),className:"caret-basic-orange-accent"})]})}),(0,s.jsx)("p",{className:"text-muted",children:n("Projects.description")}),(0,s.jsx)(u.cG,{}),(0,s.jsxs)(c.Esm,{className:"flex sm:justify-between",children:[(0,s.jsx)(c.HMX,{asChild:!0,children:(0,s.jsx)(d.$n,{variant:"secondary",children:"Cancel"})}),(0,s.jsx)(d.$n,{form:"create-project",type:"submit",variant:"primary",isLoading:f.formState.isSubmitting,isDisabled:!f.formState.isValid,children:n("Projects.create.cta")})]})]})}function g(e){return(0,s.jsx)(c.Cff,{hideX:!0,children:(0,s.jsx)(f,{...e})})}},95027:(e,t,n)=>{"use strict";n.d(t,{MistralersConfigDialog:()=>I});var s=n(64784),a=n(13166),r=n(5936),i=n(6016),l=n(85148),o=n(8462),c=n(19664),d=n(8380),u=n(82248),h=n(42573),m=n(1883),p=n(87790),x=n(8424),f=n(75429),g=n(31991),v=n(21956),j=n(801),b=n(62367),y=n(88318),_=n(30063),N=n(35111),w=n(62044);let C={endpoint:"",inference_engine_version:"",name:"custom-engine-{model_name}",type:"",modelName:""};function P(e){let{onClose:t}=e,n=(0,w.sZ)(),r=(0,u.mN)({defaultValues:C,resolver:(0,a.u)(p.Jc)});return(0,d.useEffect)(()=>{n.customEngineConfig?r.reset(n.customEngineConfig):r.reset(C)},[r,n.customEngineConfig]),(0,s.jsxs)(g.lV,{onSubmit:r.handleSubmit(e=>{n.setCustomEngineConfig(e),t()}),form:r,children:[(0,s.jsx)(x.c75,{className:"sr-only mb-6",children:(0,s.jsx)(x.L33,{children:"Customize Harmattan config"})}),(0,s.jsxs)("div",{className:"mb-4 space-y-3",onPaste:e=>{try{let t=p.Jc.parse(JSON.parse(e.clipboardData.getData("text/plain")));r.reset(t),e.preventDefault()}catch(e){}},children:[(0,s.jsxs)(g.zB,{name:"endpoint",form:r,children:[(0,s.jsx)(g.lR,{children:"Endpoint"}),(0,s.jsx)(j.pd,{inputMode:"url",...r.register("endpoint"),placeholder:"https://example.com/api"})]}),(0,s.jsxs)(g.zB,{name:"name",form:r,children:[(0,s.jsx)(g.lR,{children:"Engine name"}),(0,s.jsx)(j.pd,{...r.register("name"),placeholder:"engine"}),(0,s.jsxs)(g.mH,{children:["Interpolations: ","{model_name}"," → model name as sent to Harmattan"]})]}),(0,s.jsxs)(g.zB,{name:"inference_engine_version",form:r,children:[(0,s.jsx)(g.lR,{children:"Inference engine version"}),(0,s.jsx)(j.pd,{variant:"default",...r.register("inference_engine_version"),placeholder:"1.0.0"})]}),(0,s.jsxs)(g.zB,{name:"type",form:r,children:[(0,s.jsx)(g.lR,{children:"Engine type"}),(0,s.jsx)(j.pd,{variant:"default",...r.register("type"),placeholder:"vllm"})]}),(0,s.jsxs)(g.zB,{name:"modelName",form:r,children:[(0,s.jsx)(g.lR,{children:"Model name"}),(0,s.jsx)(j.pd,{...r.register("modelName"),placeholder:"Custom model name"})]})]}),(0,s.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,s.jsxs)(f.$n,{variant:"secondary",onClick:()=>{n.deleteCustomEngineConfig(),r.reset(C),t()},children:["Clear",(0,s.jsx)(f.qF,{icon:l.A})]}),(0,s.jsx)("div",{className:"grow"}),(0,s.jsxs)(y.m_,{children:[(0,s.jsx)(y.k$,{asChild:!0,children:(0,s.jsxs)(f.$n,{variant:"secondary",onClick:async()=>{await r.trigger()&&await navigator.clipboard.writeText(JSON.stringify(r.getValues())).then(()=>{(0,x.oRP)("Config copied to clipboard")})},children:["Export",(0,s.jsx)(f.qF,{icon:o.A})]})}),(0,s.jsx)(y.ZI,{children:"This will copy a config object to your clipboard. Paste this object into any field of the form to re-import it."})]}),(0,s.jsx)(f.$n,{type:"submit",children:"Save"})]})]})}function k(e){let{onClose:t}=e,n=(0,w.We)(),r=(0,u.mN)({defaultValues:{endpoint:""},resolver:(0,a.u)(m.Ik({endpoint:m.Yj()}))});return(0,d.useEffect)(()=>{n.endpoint?r.reset({endpoint:n.endpoint}):r.reset({endpoint:""})},[r,n.endpoint]),(0,s.jsxs)(g.lV,{onSubmit:r.handleSubmit(e=>{n.setEndpoint(e.endpoint),t()}),form:r,children:[(0,s.jsx)(x.c75,{className:"sr-only mb-6",children:(0,s.jsx)(x.L33,{children:"Customize completion API URL"})}),(0,s.jsxs)(g.zB,{name:"endpoint",form:r,className:"mt-4 mb-8",children:[(0,s.jsx)(g.lR,{children:"Harmattan endpoint"}),(0,s.jsx)(j.pd,{...r.register("endpoint"),placeholder:"https://api.mistral.ai"})]}),(0,s.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,s.jsxs)(f.$n,{variant:"secondary",onClick:()=>{n.setEndpoint(""),r.reset({endpoint:""}),t()},children:["Clear",(0,s.jsx)(f.qF,{icon:l.A})]}),(0,s.jsx)("div",{className:"grow"}),(0,s.jsx)(f.$n,{type:"submit",children:"Save"})]})]})}function A(e){let{onClose:t}=e,n=(0,w.$3)(),[o,c]=(0,d.useState)(),p=N.api.internal.checkAssistantMessage.useMutation({onSuccess:e=>{let{isJSON:t,isValidSystemMessage:n}=e;if(!t)return void c("No JSON detected. SP will be text only.");n&&t?c("Valid JSON system message."):c("Valid JSON, but not a valid system message. SP will be text only.")}}),b=(0,h._6)(e=>{p.mutate({serializedAssistantMessageContent:e})},1500),y=(0,u.mN)({defaultValues:{temperature:n.parameters.temperature,systemPrompt:n.parameters.systemPrompt},resolver:(0,a.u)(m.Ik({temperature:m.KC([m.ai().min(0).max(1),m.oi().transform(()=>void 0)]),systemPrompt:m.Yj().optional()}))});return(0,s.jsxs)(g.lV,{onSubmit:y.handleSubmit(e=>{n.setParameters(e),t()}),form:y,children:[(0,s.jsx)(x.c75,{className:"sr-only mb-6",children:(0,s.jsx)(x.L33,{children:"Customize model parameters"})}),(0,s.jsxs)(g.zB,{name:"temperature",form:y,className:"mt-4 mb-8",children:[(0,s.jsx)(g.lR,{children:"Temperature"}),(0,s.jsx)(j.pd,{type:"number",...y.register("temperature",{valueAsNumber:!0}),placeholder:"0.15",step:.01})]}),(0,s.jsxs)(g.zB,{name:"systemPrompt",form:y,className:"mb-8 flex flex-col gap-2",children:[(0,s.jsx)(g.lR,{children:"System prompt"}),(0,s.jsx)("pre",{children:(0,s.jsx)(x.No,{...y.register("systemPrompt",{onChange:()=>{let e=y.getValues().systemPrompt;if(!e||""===e){b.cancel(),c(void 0);return}b(e)}}),className:"sm:text-xs"})}),o&&(0,s.jsx)(r.N,{children:(0,s.jsx)(i.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,s.jsx)(v.F,{children:o})})})]}),(0,s.jsxs)("div",{className:"flex justify-between gap-3",children:[(0,s.jsxs)(f.$n,{variant:"secondary",onClick:()=>{n.deleteParameters(),y.reset({temperature:void 0,systemPrompt:void 0}),t()},children:["Clear",(0,s.jsx)(f.qF,{icon:l.A})]}),(0,s.jsx)("div",{className:"grow"}),(0,s.jsx)(f.$n,{type:"submit",children:"Save"})]})]})}function I(e){let{className:t}=e,{endpoint:n}=(0,w.We)(),{customEngineConfig:a}=(0,w.sZ)(),{parameters:r}=(0,w.$3)(),i=(0,w.sZ)(),l=(0,w.We)(),[o,u]=(0,d.useState)(!1);return(0,s.jsxs)(x.lGe,{open:o,onOpenChange:e=>{u(e)},children:[(0,s.jsx)(x.zMO,{className:t,onClick:()=>u(!0),children:i.customEngineConfig?(0,s.jsx)("span",{className:"text-xs font-semibold text-(--purple-500)",children:i.customEngineConfig.endpoint||"custom harmattan config"}):l.endpoint?(0,s.jsx)("span",{className:"text-xs font-semibold text-(--purple-500)",children:l.endpoint}):r.temperature||r.systemPrompt?(0,s.jsx)(c.A,{className:"text-secondary-500 size-4 text-(--purple-500)"}):(0,s.jsx)(c.A,{className:"text-secondary-500 size-4"})}),(0,s.jsx)(x.Cff,{"aria-describedby":"",children:(0,s.jsxs)(b.tU,{children:[(0,s.jsxs)(b.j7,{children:[(0,s.jsx)(b.oz,{value:"engine",className:(0,_.cn)(a&&"!text-(--purple-500)"),children:"Custom vLLM (prod Harmattan)"}),(0,s.jsx)(b.oz,{value:"endpoint",className:(0,_.cn)(n&&"!text-(--purple-500)"),children:"Custom Harmattan"}),(0,s.jsx)(b.oz,{value:"other",className:(0,_.cn)(r.temperature&&"!text-(--purple-500)"),children:"Other"})]}),(0,s.jsxs)(b.T2,{children:[(0,s.jsx)(b.Kp,{value:"engine",className:"mt-6",children:(0,s.jsx)(P,{onClose:()=>u(!1)})}),(0,s.jsx)(b.Kp,{value:"endpoint",className:"mt-6",children:(0,s.jsx)(k,{onClose:()=>u(!1)})}),(0,s.jsx)(b.Kp,{value:"other",className:"mt-6",children:(0,s.jsx)(A,{onClose:()=>u(!1)})})]})]})})]})}},95183:(e,t,n)=>{"use strict";n.d(t,{Ni:()=>r,Qj:()=>a,il:()=>i});let s={done:!0,hasNext:!1},a={done:!1,hasNext:!1},r=()=>s,i=e=>({hasNext:!0,next:e,done:!1})},97435:(e,t,n)=>{"use strict";n.d(t,{default:()=>tf});var s=n(64784),a=n(18815),r=n(38178),i=n(48218),l=n(18698),o=n(12330),c=n(93706),d=n(37984),u=n(8380),h=n(30817),m=n(80383),p=n(18544),x=n(73672),f=n(32987),g=n(8424),v=n(75429),j=n(62367),b=n(30063),y=n(50259),_=n(34435),N=n(6974),w=n(8866),C=n(9360),P=n(35111),k=n(38163),A=n(58196),I=n(63929),E=n.n(I),S=n(99463);function M(e){let{href:t,onClick:n,children:a,className:r}=e,[i,l]=(0,u.useState)(!1);return(0,s.jsxs)(E(),{className:(0,b.cn)("group/link flex items-center justify-between gap-2 rounded-4 border-1 border-default bg-default px-3 py-2.5 text-sm font-medium outline-4 outline-basic-gray-alpha-4",r),href:t,onClick:n,onMouseEnter:()=>{l(!0)},onMouseLeave:()=>{l(!1)},children:[(0,s.jsxs)("div",{className:"flex gap-1.5",children:[(0,s.jsx)(A.A,{className:"size-5 text-icon-default-disabled group-hover/link:text-brand-500"}),(0,s.jsx)("span",{className:"truncate text-default",children:a})]}),(0,s.jsx)(S.e,{animate:i,size:"sm"})]})}var D=n(24999),z=n(97561),T=n(44892),R=n(68084),L=n(77624),O=n(38256),B=n(35287),F=n(97870),G=n(28008),U=n(18019),H=n(6734),W=n(6016),V=n(12171),$=n(94122),K=n(35486),Y=n(81416),Q=n(65043),J=n(85148),Z=n(74789);let X=function(){let{onSettled:e,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=P.api.useUtils();return P.api.chat.updateTitle.useMutation({...t,onSettled:function(){for(var t=arguments.length,s=Array(t),a=0;a<t;a++)s[a]=arguments[a];n.chat.last.invalidate(Z.J),null==e||e(...s)}})};var q=n(5936),ee=n(32735),et=n(91518);let en=e=>{let{actions:t,isActive:n}=e;return(0,s.jsxs)(g.rId,{children:[(0,s.jsx)(g.tyb,{asChild:!0,children:(0,s.jsx)("div",{className:(0,b.cn)("flex h-5 cursor-pointer items-center justify-center overflow-hidden rounded-md text-icon-default-muted transition-[opacity] hover:bg-state-ghost-hover active:bg-state-ghost-press",n?"w-6 opacity-100":"w-0 opacity-0 group-hover/button:w-6 sm:group-hover/button:opacity-100"),role:"button",tabIndex:0,"aria-label":"More options",children:(0,s.jsx)(F.A,{className:"size-4"})})}),(0,s.jsx)(g.SQm,{className:"max-w-[70vw] min-w-56 rounded-xl bg-default text-subtle **:text-left sm:max-w-80 dark:text-default",align:"start",side:"bottom",sideOffset:8,alignOffset:-4,avoidCollisions:!0,collisionPadding:16,children:t.map((e,t)=>{let{label:n,onClick:a,Icon:r}=e;return(0,s.jsxs)(g._26,{className:"gap-2",onClick:e=>{e.stopPropagation(),a(e)},children:[(0,s.jsx)(r,{className:"size-4"}),n]},t.toString())})})]})},es=e=>{let{Icon:t}=e;return(0,ee.YW)(t).with(void 0,()=>null).with(null,()=>null).when(u.isValidElement,e=>e).otherwise(e=>(0,s.jsx)(e,{className:"h-5 max-w-5 min-w-5 group-hover/button:text-brand-500"}))},ea=e=>{let{children:t,menuType:n,...a}=e;return"main"===n?(0,s.jsx)(g.Bx2.MenuItem,{children:(0,s.jsx)(g.Bx2.MenuMainButton,{...a,children:t})}):(0,s.jsx)(g.Bx2.MenuItem,{children:(0,s.jsx)(g.Bx2.MenuMainButtonOption,{...a,children:t})})},er=e=>{let{label:t,menuType:n,Icon:a,href:r,isBeta:i,isActive:l,submenu:o,trigger:c,actions:d,onClick:h,className:m,...p}=e,x=null!=c?c:u.Fragment,f=null==d?void 0:d.filter(e=>!e.hide);return(0,s.jsxs)(x,{children:[(0,s.jsx)(ea,{asChild:!0,menuType:n,isActive:l,className:(0,b.cn)("group/button",!!f&&"secondary"===n&&"pe-2",m),onClick:h,...p,children:((e,t)=>t?(0,s.jsx)(E(),{href:t,children:e}):(0,s.jsx)("div",{role:"button",children:e}))((0,s.jsxs)("div",{className:"flex w-full items-center gap-4",children:[(0,s.jsx)(es,{Icon:a}),"string"==typeof t?(0,s.jsx)(G.o5,{size:"sm",tag:"span",className:"flex-1 truncate text-left capitalize",children:t}):(0,s.jsx)(s.Fragment,{children:t}),i&&(0,s.jsx)(et.Ex,{size:"sm",className:"ms-auto",colorScheme:"cyan",children:"Beta"}),f&&(0,s.jsx)(en,{actions:f,isActive:l})]}),r)}),(0,s.jsx)(q.N,{children:o&&(0,s.jsx)(W.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},children:o})})]})};var ei=n(42573);function el(e){let{title:t,setIsEditing:n,mutateTitle:a}=e,[r,i]=(0,u.useState)(t),l=(0,u.useRef)(null),o=()=>{a(r),n(!1)};return(0,ei.Wr)(l,o),(0,s.jsx)("div",{className:"flex h-full min-h-6 w-full min-w-full items-start justify-between gap-2 rounded-lg bg-muted p-2",children:(0,s.jsx)(g.No,{autoFocus:!0,ref:l,value:r,minRows:1,maxRows:2,onChange:e=>{i(e.target.value)},onFocus:e=>{let t=e.currentTarget,n=t.value.length;t.setSelectionRange(n,n)},className:"focus-visible:ring-none resize-none rounded-xs border border-transparent bg-muted px-[3px] py-0 text-sm! leading-5.5! font-normal break-words outline outline-4 outline-(--secondary-100) focus-visible:ring-0 focus-visible:ring-offset-0 focus-visible:outline focus-visible:outline-4 focus-visible:outline-(--secondary-100)",onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||e.nativeEvent.isComposing||229===e.keyCode?"Escape"===e.key&&n(!1):(e.preventDefault(),o())}})})}function eo(e){let{id:t,editable:n,title:a,userTitle:r,generatedTitle:i,pinned:l,isSubItem:d=!1,onStar:h,onUnstar:m,onArchive:p,onRestore:x,onDelete:f}=e,v=(0,R.q)(),j=(0,c.c3)("Chat"),{confirm:y}=(0,g.G_o)(),[_,N]=(0,u.useState)({value:r||i||a||"",animate:!1}),[w,P]=(0,u.useState)(!1),k=C.P.use.isGeneratingByChatId(),A=(0,u.useMemo)(()=>{var e;return null!=(e=k[t])&&e},[k,t]),{mutate:I}=X({onMutate:e=>{let{userTitle:t}=e;N({value:t||i||a||"",animate:!1})}});(0,u.useEffect)(()=>{i&&_.value===a&&N({value:i,animate:!0})},[i,a,_.value]);let E=(0,o.useRouter)(),S=g.Bx2.useSidebar({required:!0});if(w)return(0,s.jsx)("div",{className:(0,b.cn)("flex min-h-6 w-full shrink-0 rounded-lg"),children:(0,s.jsx)(el,{setIsEditing:P,title:_.value||"",mutateTitle:e=>{I({chatId:t,userTitle:e=e.trim()})}})});let M="/chat/".concat(t),D=v===t,z=(0,s.jsx)("div",{className:(0,b.cn)("block min-h-5.5 w-full flex-1 flex-row items-center justify-between truncate text-sm leading-5.5 font-[450]",A&&"ps-1"),children:_.animate?_.value.split("").map((e,t)=>(0,s.jsx)(W.P.span,{initial:{opacity:0,display:"none"},animate:{opacity:1,display:"inline"},transition:{duration:.25,delay:t/30},onAnimationComplete:()=>{t===_.value.length-1&&N(e=>({value:e.value,animate:!1}))},children:e},t)):_.value}),T=d?"4":"5",L=[...n?[{label:j("left_panel.actions.edit"),Icon:V.A,onClick:()=>P(!0)}]:[],...m?[{label:j("left_panel.actions.unstar"),Icon:$.A,hide:!l,onClick:()=>m(t)}]:[],...h?[{label:j("left_panel.actions.star"),Icon:K.A,hide:l,onClick:()=>h(t)}]:[],{label:j("left_panel.actions.archive"),Icon:Y.A,hide:!p,onClick:()=>null==p?void 0:p(t)},{label:j("left_panel.actions.restore"),Icon:Q.A,hide:!x,onClick:()=>null==x?void 0:x(t)},{label:j("left_panel.actions.delete"),Icon:J.A,onClick:()=>{y({title:j("delete_dialog.title"),description:j("delete_dialog.description",{messageTitle:_.value}),confirm:{label:j("delete_dialog.delete"),onClick:()=>f(t),isDestructive:!0}})}}];return(0,s.jsx)(er,{menuType:d?"secondary":"main",isActive:D,href:M,Icon:A?(0,s.jsx)(g.kt7,{className:"flex h-".concat(T," w-").concat(T," text-brand-600 dark:text-brand-300")}):l?(0,s.jsx)(K.A,{className:"flex h-".concat(T," w-").concat(T," group-hover/button:text-brand-500")}):null,onMouseOver:()=>{E.prefetch(M)},onClick:()=>{S.isMobile&&S.toggleSidebar()},label:z,actions:L})}function ec(e){let{group:t,chats:n,onStar:a,onUnstar:r,onDrop:i,onArchive:l,onRestore:o,onDelete:d}=e,h=C.P.use.sidePanelChatMode(),m=C.P.use.setSidePanelChatMode(),p=(0,c.c3)("Chat"),x=i?e=>{let{children:t}=e;return(0,s.jsx)(H.R,{shouldHighlight:e=>!!(e&&(0,U.J)(e)),className:"flex w-full flex-col",children:t})}:u.Fragment;return(0,s.jsxs)(g.Bx2.Menu,{className:"gap-0",children:["pinned"===t?null:(0,s.jsx)(g.Bx2.GroupLabel,{className:(0,b.cn)("group/label sticky top-0 z-10 flex w-full items-center justify-between rounded-none bg-sidebar-subtle p-2 text-xs text-hint"),children:(0,s.jsxs)("div",{className:"group/label flex w-full flex-row items-center justify-between gap-2 px-4",children:[(0,s.jsx)(G.o5,{variant:"subtle",children:p("left_panel.history")}),"history"===h?(0,s.jsxs)(g.rId,{children:[(0,s.jsx)(g.tyb,{asChild:!0,children:(0,s.jsx)("div",{className:(0,b.cn)("flex h-5 w-6 cursor-pointer items-center justify-center rounded-md text-icon-default-muted transition-[opacity] hover:bg-state-ghost-hover active:bg-state-ghost-press","sm:opacity-0 sm:group-hover/label:opacity-100"),role:"button",tabIndex:0,"aria-label":p("left_panel.actions.more_options"),children:(0,s.jsx)(F.A,{className:"size-4"})})}),(0,s.jsxs)(g.SQm,{children:[(0,s.jsx)(g._26,{onClick:()=>m("archived"),children:p("left_panel.archived_chats")}),(0,s.jsx)(g._26,{onClick:()=>m("shared"),children:p("left_panel.shared_chats")})]})]}):null]})}),(0,s.jsx)(x,{children:(0,s.jsx)("div",{onDrop:"pinned"===t?e=>{e.preventDefault();let t=(0,U.J)(e.dataTransfer);t&&(null==i||i(t))}:void 0,children:n.map(e=>(0,s.jsx)(eo,{...e,editable:"history"===h,onStar:a,onUnstar:r,onArchive:l,onRestore:o,onDelete:d},e.id))})})]})}function ed(){let e=(0,c.c3)("Projects.limits.max_project");return(0,s.jsxs)(g.Cff,{children:[(0,s.jsx)(g.L33,{children:e("title")}),(0,s.jsx)(G.o5,{children:e("description")})]})}var eu=n(93699),eh=n(48604),em=n(38510),ep=n(83692),ex=n(15912),ef=n(6506),eg=n(33981),ev=n(64618),ej=n(4580),eb=n(47097),ey=n(69957);function e_(e){var t,n,a,r;let{project:i,onChatDrop:l,chat:d}=e,h=C.P.use.sidePanelChatMode(),m={chatVisibility:"shared"===h?ey.j.PUBLIC:ey.j.PRIVATE,chatPermission:"history"===h?ey.J.WRITE:ey.J.READ_ONLY},p=(0,c.c3)("Chat"),[x,f]=(0,u.useState)(!1),v=P.api.project.byId.useQuery({id:null!=(r=null==i?void 0:i.id)?r:"",...m},{enabled:!!(null==i?void 0:i.id)}),j=(0,u.useMemo)(()=>{var e,t;return(0,ex.U)(function(...e){return(0,eb.T)(Object.values,e)}(null!=(t=null==(e=v.data)?void 0:e.chats)?t:[]),[(0,ef._)("pinned"),"desc"],[(0,ef._)("createdAt"),"desc"])},[null==(t=v.data)?void 0:t.chats]),y=j.length>0,_=(0,o.usePathname)(),N=!!(i&&_==="/projects/".concat(i.id)),w=null!=(n=v.data)&&!!n.chats&&Object.values(v.data.chats).some(e=>{let{id:t}=e;return _==="/chat/".concat(t)}),k=N||w,[A,I]=(0,u.useState)(k),E=A||k||w,S=e=>{e.preventDefault(),f(!0)},M=e=>{e.preventDefault(),f(!1),I(!0);let t=(0,U.J)(e.dataTransfer);t&&!j.some(e=>{let{id:n}=e;return n===t})&&l(t)},D=null==(a=(0,O.w)())?void 0:a.session,z=!!(i&&D&&i.chatCount>=(0,em.u)(D).maxChatsPerProject);return(0,s.jsx)(s.Fragment,{children:i?(0,s.jsx)(er,{menuType:"main",className:(0,b.cn)("group/project",x&&"rounded-none bg-state-soft-hover",z&&x&&"cursor-not-allowed"),Icon:(0,s.jsx)(ew,{Icon:i.icon,hasChats:y,isActive:k,onToggleOpen:()=>I(!A),isOpen:A}),href:"/projects/".concat(i.id),isActive:N,onDragOver:S,onDragLeave:()=>f(!1),onDrop:M,label:(0,s.jsx)(eC,{name:i.name,isEmpty:!y,isFull:z}),submenu:E&&(0,s.jsx)(eN,{editable:"history"===h,chats:j,chatActions:d})}):(0,s.jsx)(er,{menuType:"main",Icon:eg.A,label:p("left_panel.create_project"),className:(0,b.cn)("group/project",x&&"rounded-none bg-state-soft-hover"),trigger:g.zMO,onDragOver:S,onDragLeave:()=>f(!1),onDrop:M})})}let eN=e=>{let{chats:t,chatActions:n,editable:a}=e;return(0,s.jsx)(g.Bx2.MenuSub,{className:"ms-2",children:(0,s.jsx)(g.Bx2.Menu,{className:"gap-0 px-2.5",children:(0,s.jsx)(eP,{chats:t,chatActions:n,editable:a})})})},ew=e=>{let{hasChats:t,isActive:n,Icon:a,isOpen:r,onToggleOpen:i}=e,l=!n&&!!t,o=a?(0,s.jsx)("p",{className:(0,b.cn)("h-5 w-5","flex items-center justify-center text-lg",l&&"group-hover/project:hidden"),children:a}):(0,s.jsx)(ev.A,{className:(0,b.cn)("size-3 h-5 w-5 p-0 group-hover/project:text-brand-500",l&&"group-hover/project:hidden")});return(0,s.jsxs)(v.$n,{variant:"ghost",size:"xs",className:(0,b.cn)("p-0",n&&r&&"cursor-not-allowed",!n&&!t&&"cursor-pointer"),onClick:e=>{(n||t)&&(e.preventDefault(),e.stopPropagation(),t&&i())},children:[o,(0,s.jsx)(ej.A,{className:(0,b.cn)("h-5 w-5 group-hover/project:text-brand-500","hidden transition-transform",l&&"group-hover/project:block",(r||n)&&"rotate-180")})]})},eC=e=>{let{name:t,isEmpty:n,isFull:a}=e,r=(0,c.c3)("Chat");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.ec,{tooltip:!1,children:t}),n&&(0,s.jsx)(et.Ex,{colorScheme:"neutral",size:"sm",className:"ms-auto",children:r("left_panel.projects_section.empty_badge_label")}),a&&(0,s.jsx)(et.Ex,{colorScheme:"orange",size:"sm",className:"ms-auto",children:r("left_panel.projects_section.full_badge_label")})]})};function eP(e){let{editable:t,chatActions:n,chats:s}=e;return s.map(e=>(0,u.createElement)(eo,{editable:t,...e,...n,key:e.id,isSubItem:!0}))}function ek(e){let{projects:t,onChatAdd:n,...a}=e,r=C.P.use.sidePanelChatMode();return(0,s.jsxs)(H.R,{className:"flex flex-col",shouldHighlight:e=>!!(e&&(0,U.J)(e)),children:["history"===r?(0,s.jsx)(e_,{...a,project:null,onChatDrop:e=>n(e,null)}):null,t.length>0?(0,ex.U)(t,[(0,ef._)("updatedAt"),"desc"]).map(e=>(0,u.createElement)(e_,{...a,key:e.id,project:e,onChatDrop:t=>n(t,e.id),chat:{...a.chat,onUnstar:async t=>{var n,s;return null==(n=(s=a.chat).onUnstar)?void 0:n.call(s,t,e.id)},onStar:async t=>{var n,s;return null==(n=(s=a.chat).onStar)?void 0:n.call(s,t,e.id)}}})):null]})}function eA(e){let{session:t,projects:n,...a}=e,r=(0,o.useRouter)(),{data:i=n}=P.api.project.list.useQuery(void 0,{initialData:n}),l=!t.isLeChatPro,c=i.length>=(0,em.u)(t).maxProjects,[d,h]=(0,u.useState)(!1),[m,p]=(0,u.useState)(null),x=async e=>{var t;m&&(await f({chatId:m,projectId:e.id}),p(null)),h(!1),t=e.id,r.push("/projects/".concat(t))},{mutateAsync:f}=(0,ep.V)();return(0,s.jsx)(g.lGe,{open:d,onOpenChange:h,children:(0,s.jsxs)(g.Bx2.Menu,{className:"gap-0",children:[(0,s.jsx)(ek,{...a,projects:i,onChatAdd:(e,n)=>{if(n){let s=i.find(e=>e.id===n);s&&s.chatCount>=(0,em.u)(t).maxChatsPerProject||f({chatId:e,projectId:n})}else h(!0),p(e)}}),c?l?(0,s.jsx)(eh.a,{}):(0,s.jsx)(ed,{}):(0,s.jsx)(eu.l,{onCreateSuccess:x})]})})}function eI(e){var t,n,a;let{initialLastChats:r,initialLastPinnedChats:i,projects:l}=e,d=(0,c.c3)("Chat"),h=(0,R.q)(),m=C.P.use.sidePanelChatMode(),p="history"===m,x=(0,u.useRef)(null),f=(0,o.useRouter)(),v=null==(t=(0,O.w)())?void 0:t.session,j=(0,u.useMemo)(()=>({chatVisibility:"shared"===m?z.jZ.PUBLIC:z.jZ.PRIVATE,chatPermission:"history"===m?z.Jj.WRITE:z.Jj.READ_ONLY,includeProjectChats:!1}),[m]),b=P.api.chat.last.useInfiniteQuery(j,{initialData:()=>j.chatPermission===z.Jj.WRITE?{pages:[r],pageParams:[void 0]}:void 0,getNextPageParam:e=>e.nextCursor}),y=P.api.chat.last.useQuery(L._,{initialData:p?i:void 0}),_=b.data,N=y.data,w=(null!=(n=null==_?void 0:_.pages.flatMap(e=>e.items))?n:[]).sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime()),k=p?(null!=(a=null==N?void 0:N.items)?a:[]).sort((e,t)=>t.updatedAt.getTime()-e.updatedAt.getTime()):[],A=P.api.useUtils(),I=B.E.use.unsetDraftMessageByChatId(),E=P.api.chat.delete.useMutation({async onMutate(e){let{prevData:t,queryParams:n,deleteData:s,setDataFn:a}=U(e.id);return await A.chat.last.cancel(n),s(e.id),{prevData:t,queryParams:n,setDataFn:a}},onSuccess(e,t,n){e.projectId&&A.project.byId.invalidate({id:e.projectId}),h===t.id&&f.push("/chat")},onError(e,t,n){n&&n.setDataFn(n.queryParams,n.prevData)},async onSettled(e,t,n,s){await A.chat.last.invalidate(null==s?void 0:s.queryParams)}}),S=e=>{I(e),E.mutateAsync({id:e})},M=P.api.chat.setPermission.useMutation({async onMutate(e){let{prevData:t,queryParams:n,deleteData:s,setDataFn:a}=U(e.id);return await A.chat.last.cancel(n),s(e.id),{prevData:t,queryParams:n,setDataFn:a}},onSuccess(e,t){e.projectId&&A.project.byId.invalidate({id:e.projectId}),t.permission===z.Jj.READ_ONLY?g.oRP.success(d("left_panel.archive_success_toast")):g.oRP.success(d("left_panel.restore_success_toast")),h===t.id&&f.push("/chat")},onError(e,t,n){n&&n.setDataFn(n.queryParams,n.prevData)},onSettled(e,t,n){A.chat.last.invalidate()}}),F=p?e=>M.mutate({id:e,permission:z.Jj.READ_ONLY}):void 0,G="archived"===m?e=>M.mutate({id:e,permission:z.Jj.WRITE}):void 0,U=e=>{var t;let n=A.chat.last.getData(L._),s=(null!=(t=null==n?void 0:n.items)?t:[]).find(t=>t.id===e),a=s?A.chat.last.setData:A.chat.last.setInfiniteData,r=s?L._:j;return{prevData:s?n:A.chat.last.getInfiniteData(j),queryParams:r,deleteData:e=>{s?A.chat.last.setData(r,t=>{if(t)return(0,D.$P)(t,t=>t.id===e)}):A.chat.last.setInfiniteData(r,t=>{if(t)return(0,D.ZK)(t,t=>t.id===e)})},setDataFn:a}};(0,u.useEffect)(()=>{let e=new IntersectionObserver(e=>{var t;(null==(t=e[0])?void 0:t.isIntersecting)&&b.hasNextPage&&!b.isFetchingNextPage&&b.fetchNextPage()},{threshold:.1}),t=x.current;if(t)return e.observe(t),()=>{e.unobserve(t)}},[b]);let{canPinChat:H,mutation:W}=(0,L.Z)(),V=H&&p?async(e,t)=>{await W.mutateAsync({chatId:e,pinned:!0}),t&&A.project.byId.invalidate({id:t})}:void 0,$=async(e,t)=>{await W.mutateAsync({chatId:e,pinned:!1}),t&&A.project.byId.invalidate({id:t})};return(0,s.jsx)("div",{className:"flex min-h-0 w-full flex-1 flex-col items-start justify-start gap-3 overflow-x-hidden",children:(0,s.jsx)("div",{className:"relative flex h-full w-full flex-col items-start justify-start gap-3 overflow-hidden",children:(0,s.jsxs)(g.FKN,{className:"flex w-full flex-col items-start gap-0.5",children:[(0,s.jsxs)("div",{className:"flex w-full max-w-full flex-col items-start pb-20",children:[(0,s.jsx)(g.$H1,{orientation:"vertical",className:"z-20"}),v&&(l.length>0||p)&&(0,s.jsx)(eA,{projects:l,session:v,chat:{onUnstar:$,onStar:V,onArchive:F,onRestore:G,onDelete:S}}),k.length>0&&(0,s.jsx)(ec,{group:"pinned",chats:k,onUnstar:$,onDrop:V,onArchive:F,onRestore:G,onDelete:S}),w.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(T.cG,{className:"my-3"}),(0,s.jsx)(ec,{group:m,chats:w,onStar:V,onArchive:F,onRestore:G,onDelete:S},"stacked")]})]}),(0,s.jsx)("div",{ref:x,className:"flex-1"})]})})})}var eE=n(57583),eS=n(51327),eM=n(5300),eD=n(13166),ez=n(82248),eT=n(88049);n(98999);var eR=n(84358),eL=n(93255),eO=n(42524),eB=n(17222),eF=n(6028),eG=n(16273);function eU(e){let{children:t,className:n}=e;return(0,s.jsx)(W.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:n,children:t})}function eH(e){let{instructions:t,className:n}=e,a=(0,c.c3)("Personalization.preview"),[r,i]=(0,u.useState)(eB.U0),l=a("prompts.".concat(r)),[o,d]=(0,u.useState)(null),h=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return P.api.chat.preview.useSubscription(...t)}({message:l,instructions:function(e){let[t,n]=(0,u.useState)(null==e?void 0:e.custom);return(0,u.useEffect)(()=>{let t=setTimeout(()=>{n(null==e?void 0:e.custom)},3e3);return()=>clearTimeout(t)},[null==e?void 0:e.custom]),(0,u.useMemo)(()=>{var n;return{preset:null!=(n=null==e?void 0:e.preset)?n:"default",custom:null!=t?t:null}},[null==e?void 0:e.preset,t])}(t)},{onStarted:()=>{d(null)},onData:e=>{var t;let{data:n}=e,s=(0,ee.YW)(null==(t=n.choices.at(0))?void 0:t.delta.content).returnType().with(ee.P.string,(0,eO.D)()).with(ee.P.nullish,()=>null).with(ee.P.array(),e=>(0,ee.YW)(e.at(0)).with({type:"text"},(0,ef._)("text")).otherwise(()=>null)).exhaustive();s&&d(e=>(null!=e?e:"")+s)}});return(0,s.jsxs)("div",{className:(0,b.cn)("flex flex-col gap-4 overflow-y-auto rounded-md bg-card-subtle p-4 text-sm dark:bg-card",n),children:[(0,s.jsx)(eW,{onRefresh:()=>{d(null),i(eB.U0)}}),(0,s.jsx)(eV,{content:l}),(0,ee.YW)([h,o]).with([{status:"pending"},ee.P.nullish],()=>(0,s.jsx)(e$,{content:"..."})).with([{status:ee.P.union("idle","pending")},ee.P.nonNullable],e=>{let[,t]=e;return(0,s.jsx)(e$,{content:t})}).otherwise(()=>null)]})}function eW(e){let{onRefresh:t}=e,n=(0,c.c3)("Personalization.preview");return(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)(eF.vu,{pressed:!1,onPressedChange:t,"aria-label":n("refresh"),children:(0,s.jsx)(eF.gM,{icon:eR.A})})})}function eV(e){let{content:t}=e;return(0,s.jsx)(G.o5,{className:"ms-auto max-w-11/12 rounded-xl bg-state-secondary p-4",children:t})}function e$(e){let{content:t}=e;return(0,s.jsxs)(eU,{className:"grid grid-cols-[min-content_1fr] grid-rows-[100%] gap-2",children:[(0,s.jsx)(eG.n,{session:null,className:"rounded-sm"}),(0,s.jsx)("div",{className:"markdown-container-style overflow-hidden text-ellipsis",children:(0,s.jsx)(eL.oz,{components:{hr:()=>null},children:t})})]})}var eK=n(31042),eY=n(30709),eQ=n(31991),eJ=n(63309);let eZ=eJ.Ay.object({preset:eJ.Ay.enum(eB.Xg),custom:eJ.Ay.string().nullable()}),eX={custom:null,preset:"default"};function eq(){return eB.ho.toSorted(()=>(0,eY.M)(-1,1)).slice(0,8)}function e0(){let e=(0,ez.xW)(),t=(0,c.c3)("Personalization.instruction"),[n,a]=(0,u.useState)(eq);return(0,s.jsx)(eQ.zB,{form:e,name:"custom",className:"grid grid-rows-[1fr_auto] gap-4",children:e=>{var r;let{field:i}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eQ.lR,{children:t("custom.title")}),(0,s.jsx)(g.TMX,{...i,value:null!=(r=i.value)?r:"",placeholder:t("custom.placeholder"),rows:5}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[n.map(e=>(0,s.jsx)(eF.vu,{pressed:!1,"aria-label":t("custom.add_suggestion_label"),onPressedChange:()=>{var n,s;let r=null!=(s=null==(n=i.value)?void 0:n.trim())?s:"",l=t("custom.suggestions.".concat(e));i.onChange(r?"".concat(r,"\n").concat(l):l),a(t=>t.filter(t=>t!==e))},children:t("tone.options.".concat(e))},e)),(0,s.jsx)(eF.vu,{pressed:!1,onPressedChange:()=>a(eq),"aria-label":t("custom.refresh_suggestions_label"),children:(0,s.jsx)(eF.gM,{icon:eK.A})})]})]})}})}var e1=n(82586);function e3(){let e=(0,ez.xW)(),t=(0,c.c3)("Personalization.instruction.preset");return(0,s.jsx)(eQ.zB,{form:e,name:"preset",className:"relative flex flex-col gap-2",children:e=>{let{field:n}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eQ.lR,{children:t("title")}),(0,s.jsxs)(g.l6P,{...n,onValueChange:n.onChange,children:[(0,s.jsx)(g.bqE,{children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(e1.A,{size:16}),(0,s.jsx)(g.yvm,{})]})}),(0,s.jsx)(g.gCo,{children:eB.Xg.map(e=>(0,s.jsx)(g.ebT,{value:e,children:t("".concat(e,".title"))},e))})]}),(0,s.jsx)(G.o5,{className:"text-sm text-subtle",children:t("".concat(n.value,".description"))})]})}})}function e2(e){let{custom:t,...n}=e;return{...n,custom:t||null}}function e5(e){let{onSubmit:t,defaultValues:n=null}=e,a=(0,c.c3)(),r=(0,ez.mN)({defaultValues:{...eX,...n},resolver:(0,eD.u)(eZ)}),i=r.handleSubmit(function(...e){return t=>(0,eT.F)(t,...e)}(e2,t)),l=r.formState.isValid&&r.formState.isDirty;return(0,s.jsxs)(ez.Op,{...r,children:[(0,s.jsxs)("form",{id:"instructions-form",onSubmit:i,className:"flex h-full flex-col gap-4",children:[(0,s.jsx)(e3,{}),(0,s.jsx)(T.cG,{}),(0,s.jsx)(e0,{}),(0,s.jsx)(v.$n,{type:"submit",variant:"brand",isDisabled:!l,isLoading:r.formState.isSubmitting,className:"mt-auto w-fit",children:a("General.actions.save")})]}),(0,s.jsx)(eH,{instructions:e2(r.watch()),className:"hidden h-full lg:flex"})]})}let e8={version:3};function e4(e){var t;let{children:n}=e,a=(0,c.c3)(),[r,i]=(0,u.useState)(!1),{data:l}=(t={version:3},P.api.user.getPersonalization.useQuery(t,void 0)),{mutate:o}=function(e){let t=(0,c.c3)("Personalization"),n=P.api.useUtils();return P.api.user.setPersonalization.useMutation({onMutate:(t,s)=>{var a;null==e||null==(a=e.onMutate)||a.call(e,t,s);let r=n.user.getPersonalization.getData(e8);return n.user.getPersonalization.cancel(),n.user.getPersonalization.setData(e8,t.personalization),{previousData:r}},onSuccess:function(n,s){for(var a,r=arguments.length,i=Array(r>2?r-2:0),l=2;l<r;l++)i[l-2]=arguments[l];null==e||null==(a=e.onSuccess)||a.call(e,n,s,...i),(0,g.oRP)(t("save.success.message"))},onError:(s,a,r,i)=>{var l;null==e||null==(l=e.onError)||l.call(e,s,a,r,i),(0,g.oRP)(t("save.error.message")),(null==r?void 0:r.previousData)&&n.user.getPersonalization.setData(e8,r.previousData)}})}({onSuccess:()=>i(!1)});return(0,s.jsxs)(g.lGe,{open:r,onOpenChange:i,children:[(0,s.jsx)(g.zMO,{children:n}),(0,s.jsxs)(g.Cff,{className:"xs:grid-cols-1 grid h-[65vh] max-h-[620px] min-h-[min(98vh,500px)] w-[calc(100vw-2rem)] max-w-none grid-rows-[auto_1fr] gap-x-4 gap-y-10 overflow-auto md:w-[450px] lg:w-[860px] lg:grid-cols-2",children:[(0,s.jsx)(g.c75,{className:"xs:col-span-1 md:col-span-2",children:(0,s.jsx)(g.L33,{children:a("Personalization.title")})}),(0,s.jsx)(e5,{defaultValues:null==l?void 0:l.instructions,onSubmit:e=>o({personalization:{version:3,instructions:e}})})]})]})}var e6=n(89510),e7=n(52849),e9=n(38875),te=n(81118),tt=n(76863),tn=n(52907),ts=n(8492),ta=n(87985),tr=n(88318),ti=n(92708);let tl=()=>{let e=(0,c.c3)("Billing");return(0,u.useCallback)(t=>{let{leChatPlan:n,orgTier:s}=t;return(0,ti.v)({leChatPlan:n,orgTier:s,t:e})},[e])},to=e=>{let{leChatPlan:t,isLeChatPro:n,orgTier:a,isAdmin:r}=e,i=tl(),l=(0,c.c3)("Chat"),o=tl()({leChatPlan:t,orgTier:a});return(0,s.jsx)("span",{className:"flex items-center gap-1",children:t!==h._C.TEAM||n?i({leChatPlan:t,orgTier:a}):(0,s.jsxs)(s.Fragment,{children:[i({leChatPlan:null,orgTier:a}),(0,s.jsxs)(tr.m_,{children:[(0,s.jsx)(tr.k$,{asChild:!0,children:(0,s.jsx)(A.A,{className:"size-[1.1625em]"})}),(0,s.jsx)(tr.ZI,{className:"m-2",children:l(r?"user_nav.admin_upgrade_hint":"user_nav.request_upgrade_hint",{chatPlanName:o})})]})]})})};var tc=n(82710);let td=e=>e.map(e=>{let{key:t,label:n,onClick:a,icon:r,href:i,checked:l}=e;return i?(0,s.jsx)(E(),{href:i,target:i.startsWith("http")?"_blank":void 0,rel:i.startsWith("http")?"noopener":void 0,children:(0,s.jsxs)(g._26,{className:"gap-2",onClick:a,children:[r,n]},t)},t):(0,s.jsxs)(g._26,{className:"gap-2",onClick:a,children:[r,(0,s.jsx)("div",{className:"flex-1",children:n}),l&&(0,s.jsx)(tc.A,{className:"me-2 size-4",strokeWidth:2.5})]},t)});var tu=n(94399),th=n(13797);let tm=e=>{let{session:t}=e,n=t.organization,{data:a,isLoading:r}=P.api.organization.all.useQuery(),i=P.api.session.setActiveOrganization.useMutation(),l=(0,c.c3)("Chat"),o=(0,u.useMemo)(()=>{if(!a)return[{id:n.id,name:n.name,role:t.role,leChatPlan:t.leChatPlan,isLeChatPro:t.isLeChatPro,orgTier:t.organization.orgTier}];let e=a.items;return[e.find(e=>e.id===n.id),...e.filter(e=>e.id!==n.id)]},[a,n.id,n.name,t.role,t.leChatPlan,t.isLeChatPro,t.organization.orgTier]);return(0,s.jsxs)("div",{className:"flex max-h-[220px] flex-col gap-1 overflow-y-auto",children:[o.map(e=>(0,s.jsxs)(g._26,{"data-active":e.id===n.id,className:(0,b.cn)("border-s-2 border-transparent hover:bg-state-soft focus:bg-state-soft",e.id===n.id?"cursor-default bg-badge-orange":"hover:bg-badge-orange focus:bg-badge-orange data-[active=true]:font-medium","transition-colors data-[active=true]:border-s-brand-500 data-[active=true]:font-medium"),onClick:t=>{if(t.preventDefault(),e.id!==n.id){var s;s=e.id,i.mutate({id:s},{onSuccess:()=>{g.oRP.success(l("user_nav.switch_organization_success")),window.location.href="/"},onError:e=>{g.oRP.error(e.message)}})}},disabled:i.isPending,children:[(0,s.jsx)(g.uQp,{organizationName:e.name,info:(0,s.jsx)(to,{isAdmin:e.role===h.gG.ADMIN,leChatPlan:e.leChatPlan,isLeChatPro:e.isLeChatPro,orgTier:e.orgTier}),highlight:e.isLeChatPro,tooltipOptions:{side:"right"},size:"smaller"},e.id),(0,th.xQ)({userRole:e.role})?(0,s.jsx)(tn.v,{className:"me-2 size-4",mode:"icon-only",icon:tu.A,variant:"ghost",size:"xs",target:"_blank",rel:"noopener noreferrer",href:N._.NEXT_PUBLIC_SETTINGS_URL,onClick:e=>{e.stopPropagation()},children:(0,s.jsx)(v.GM,{children:l("navigation_bar.settings_button_tooltip")})}):null]},e.id)),r?(0,s.jsx)(g.EAD,{className:"h-12 w-full"}):null]})};function tp(e){let{sessionMode:t}=e,{session:n}=(0,O.d)(),a=(0,ei.DE)(),r=(0,o.useRouter)(),i=(0,c.c3)("Chat"),l=(0,c.c3)("Shared"),{theme:p,setTheme:x}=(0,d.D)(),{openProfileDialog:f}=(0,m.tQ)(),{desktopApi:j}=(0,ts.A)(),b=(0,u.useMemo)(()=>[[(0,s.jsx)("div",{className:"px-2",children:(0,s.jsx)(g.Cc3,{userName:n.user.name,orgName:n.user.name,info:n.user.email,tooltipOptions:{side:"right"},size:"smaller"})},"header-avatar"),...td([{key:"profile",label:l("Account.sidebar.profileSettings"),icon:(0,s.jsx)(e6.A,{}),onClick:()=>f()},...N._.NEXT_PUBLIC_READ_ONLY_PROFILE?[]:[{key:"security",label:l("Account.sidebar.dialog.security"),icon:(0,s.jsx)(e7.A,{}),onClick:()=>f(m.XD.Security)}],{key:"preferences",label:l("Account.sidebar.dialog.preferences"),icon:(0,s.jsx)(e9.A,{}),onClick:()=>f(m.XD.Preferences)}])],..."dashboard"===t&&!N._.NEXT_PUBLIC_SINGLE_ORG_DEPLOYMENT&&a?[[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4",children:[(0,s.jsx)(G.o5,{variant:"muted",size:"sm",children:i("user_nav.organizations_header")}),(0,s.jsx)(tn.v,{className:"size-4",mode:"icon-only",icon:te.A,variant:"ghost",size:"xs",target:"_blank",rel:"noopener noreferrer",href:"".concat(N._.NEXT_PUBLIC_SETTINGS_URL,"/join?return_to=").concat(encodeURIComponent(window.location.href)),children:(0,s.jsx)(v.GM,{children:i("user_nav.new_organization")})})]},"organisations-header"),(0,s.jsx)(tm,{session:n},"organisations-list")]]:[],[...td([{key:"t&cs",label:i("user_nav.terms_and_conditions_button"),href:"https://mistral.ai/terms#terms-of-service"},{key:"help-center",label:i("user_nav.help_center_button"),href:"https://help.mistral.ai"},{key:"logout",label:"Logout",onClick:()=>{j?j.logout():r.push("/logout")}}])],[(0,s.jsx)("div",{className:"mx-2 inline-flex gap-2 rounded-md bg-muted p-1",children:ta.F.map(e=>{let{Icon:t,theme:n}=e;return(0,s.jsx)(g._26,{className:"gap-2 ".concat(p===n?"rounded-sm border border-darker bg-state-secondary":""),onClick:e=>{e.preventDefault(),x(n)},children:(0,s.jsx)(t,{className:"h-4 w-4"})},n)})},"mode-toggle")]],[n,l,t,a,i,f,j,r,p,x]),y=P.api.useUtils();return(0,s.jsx)(g.Bx2.Menu,{children:(0,s.jsx)(g.Bx2.MenuItem,{children:(0,s.jsxs)(g.rId,{children:[(0,s.jsx)(g.tyb,{asChild:!0,children:(0,s.jsxs)(g.Bx2.MenuButton,{size:"lg",className:"gap-3 rounded-lg pe-1.5",onMouseEnter:()=>{y.organization.all.prefetch()},children:[(0,s.jsx)(g.Cc3,{userName:n.user.name,orgName:n.organization.name,info:(0,s.jsx)(to,{isAdmin:n.role===h.gG.ADMIN,leChatPlan:n.leChatPlan,isLeChatPro:n.isLeChatPro,orgTier:n.organization.orgTier}),highlight:n.isLeChatPro,tooltipOptions:{side:"right"},size:"smaller"}),(0,s.jsx)(tt.A,{className:"size-4"})]})}),(0,s.jsx)(g.SQm,{className:"max-h-[var(--radix-dropdown-menu-content-available-height)] w-[16rem] overflow-y-auto py-2",side:"bottom",align:"start",sideOffset:8,alignOffset:-4,avoidCollisions:!0,collisionBoundary:a?document.body:void 0,collisionPadding:16,children:(0,s.jsx)("div",{children:b.map((e,t)=>(0,s.jsxs)(u.Fragment,{children:[0!==t&&(0,s.jsx)(g.mBJ,{}),(0,s.jsx)(g.lvB,{children:e.map(e=>(0,s.jsx)("div",{className:"w-full py-1",children:e},e.key))})]},t.toString()))})})]})})})}let tx=()=>{let e=!["staging","development","preprod"].includes(N._.NEXT_PUBLIC_ENVIRONMENT),{data:t}=P.api.version.current.useQuery(void 0,{refetchOnWindowFocus:!1,enabled:!e});return e?null:(0,s.jsx)(g.m7H,{className:"mx-4 w-auto",envValue:N._.NEXT_PUBLIC_ENVIRONMENT,version:null==t?void 0:t.version})};function tf(e){let{initialLastChats:t,initialLastPinnedChats:n,projects:P,session:A,sessionMode:I}=e,E=(0,c.c3)("Chat"),S=(0,c.c3)("General"),D=g.Bx2.useSidebar({required:!0}),{resolvedTheme:z}=(0,d.D)(),T=(0,o.useRouter)(),R=(0,o.usePathname)(),L=C.P.use.sidePanelChatMode(),O=C.P.use.setSidePanelChatMode();(0,f.E)("mod+shift+h",()=>{T.push("/chat")},{preventDefault:!0});let B=A.organization.featureFlags.regles_du_jeu,F=!N._.NEXT_PUBLIC_DISABLE_DOCUMENT_LIBRARY,G=(0,x.C)(p.EM)||(0,x.C)(p.H5)||(0,x.C)(p.OQ),U=(0,x.C)(p.K6),H=A.canUpgradeToPro&&"dashboard"===I,W=A.canUpgradeToTeam&&"dashboard"===I,V="history"===L,$=!V||H||W||D.isMobile,{track:K}=(0,w.n)(),Y=(0,_.Z)(),Q=()=>{K(w.f.UPGRADE_CTA_CLICKED,{source:"chat_sidebar"})},J=C.P.use.sidePanelAnnouncementMode(),{navItems:Z}=(e=>{let{pathname:t,permissions:n}=e,a=t.startsWith("/memories")||t.startsWith("/connections")||t.startsWith("/libraries"),r=(0,c.c3)("Chat"),i=g.Bx2.useSidebar({required:!0}),[l,o]=(0,u.useState)(a),{canUseLibraries:d,canUseConnectors:h,canUseInstructions:m,canUseMemories:p}=n;return{navItems:(0,u.useMemo)(()=>{let e=[{hide:!p,label:r("left_panel.memories"),href:"/memories",isActive:t.startsWith("/memories")},{hide:!h,label:r("left_panel.connectors"),href:"/connections",isActive:t.startsWith("/connections")},{hide:!d,label:r("left_panel.libraries"),href:"/libraries",isActive:t.startsWith("/libraries")},{hide:!m,label:r("left_panel.personalization"),isActive:!1,trigger:e4}];return[{label:r("new_chat"),Icon:eE.A,onClick:()=>{i.isMobile&&i.toggleSidebar()},href:"/chat",isActive:"/chat"===t},{label:r("left_panel.agents"),Icon:eS.A,onClick:()=>{i.isMobile&&i.toggleSidebar()},href:"/agents",isBeta:Object.values(n).every(e=>!1===e),isActive:t.startsWith("/agents")},{label:r("left_panel.intelligence"),Icon:eM.A,hide:Object.values(n).every(e=>!1===e),onClick:()=>{o(e=>!e)},isBeta:!0,submenu:l||a?(0,s.jsx)(g.Bx2.MenuSub,{className:"ms-2",children:(0,s.jsx)(g.Bx2.Menu,{className:"gap-0 px-2.5",children:e.filter(e=>!e.hide).map(e=>{let{hide:t,...n}=e;return(0,s.jsx)(er,{menuType:"secondary",...n},n.label)})})}):null}]},[r,i,t,n,p,d,h,m,l,a])}})({pathname:R,permissions:{canUseLibraries:F,canUseConnectors:G,canUseInstructions:B,canUseMemories:U}});return(0,s.jsxs)(g.Bx2.Sidebar,{variant:"inset",collapsible:"icon",className:(0,b.cn)(J&&!D.open&&"*:data-sidebar:bg-linear-to-t *:data-sidebar:from-[#fff4b8] *:data-sidebar:to-transparent *:data-sidebar:dark:from-[#723515]","border-e-[0.5px] border-default p-0 outline-2 outline-basic-gray-alpha-15/20 group-data-[collapsible=icon]:border-0 group-data-[collapsible=icon]:outline-none"),children:[(0,s.jsx)(g.Bx2.Header,{className:"mb-8 flex w-full flex-col justify-between px-2.5 pt-2 pb-0 desktop-mac:pt-8",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("div",{className:"flex-1",children:V?(0,s.jsx)(m.Nj,{userRole:A.role,variant:z||"light",compact:!0}):(0,s.jsxs)(v.$n,{size:"xs",onClick:()=>O("history"),children:[(0,s.jsx)(v.IM,{children:(0,s.jsx)(a.A,{className:"size-4"})}),(0,s.jsx)("span",{children:E("left_panel.back_to_history")})]})}),(0,s.jsx)(v.$n,{className:"w-9 text-icon-default-muted",mode:"icon-only",size:"xs",variant:"ghost",icon:r.A,onClick:()=>{Y.setOpen(!0)},children:(0,s.jsx)(v.GM,{children:(0,s.jsx)(y.m,{hotkey:"mod+k",className:"bg-transparent text-hint"})})}),D.isMobile?null:(0,s.jsx)(v.$n,{className:"w-9 text-icon-default-muted",mode:"icon-only",size:"xs",variant:"ghost",icon:i.A,onClick:()=>{D.toggleSidebar()}})]})}),(0,s.jsxs)(g.Bx2.Content,{className:"gap-8 p-0",children:[V?(0,s.jsx)(g.Bx2.Menu,{className:"gap-0",children:Z.filter(e=>!e.hide).map(e=>{let{hide:t,...n}=e;return(0,s.jsx)(er,{menuType:"main",...n},n.label)})}):(0,s.jsx)(j.tU,{value:L,onValueChange:e=>O(e),children:(0,s.jsxs)(j.j7,{className:"w-full",children:[(0,s.jsx)(j.oz,{value:"shared",children:E("left_panel.shared")}),(0,s.jsx)(j.oz,{value:"archived",children:E("left_panel.archived")})]})}),(0,s.jsx)(u.Suspense,{fallback:(0,s.jsx)("div",{className:"flex-1"}),children:(0,s.jsx)(eI,{initialLastChats:t,initialLastPinnedChats:n,projects:P})})]}),(0,s.jsxs)(g.Bx2.Menu,{children:[(0,s.jsx)(g.Bx2.MenuItem,{className:"px-4 py-5",children:(0,s.jsx)(tp,{sessionMode:I})}),(0,s.jsx)(tx,{})]}),$?(0,s.jsxs)(g.Bx2.Footer,{className:"border-t border-basic-gray-alpha-4 px-4 py-5",children:[H?(0,s.jsx)(M,{href:"/upgrade",onClick:Q,children:E.rich("left_panel.upgrade_prompt",{strong:e=>(0,s.jsx)("strong",{className:"font-semibold text-brand-500",children:e}),plan:h._C.INDIVIDUAL})}):W?(0,s.jsx)(M,{href:"/upgrade",onClick:Q,children:E.rich("left_panel.upgrade_prompt",{strong:e=>(0,s.jsx)("strong",{className:"font-semibold",children:e}),plan:h._C.TEAM})}):null,V?D.isMobile?(0,s.jsx)(k.HelpHubButton,{showIntercom:A.isLeChatPro,children:(0,s.jsxs)(v.$n,{variant:"secondary",className:"w-full",children:[(0,s.jsx)(v.IM,{children:(0,s.jsx)(l.A,{className:"size-4"})}),S("help_hub.title")]})}):null:(0,s.jsxs)(g.Bx2.MenuButton,{onClick:()=>O("history"),className:"gap-2",children:[(0,s.jsx)(a.A,{className:"size-4"}),(0,s.jsx)("span",{children:E("left_panel.back_to_history")})]})]}):null]})}},98999:()=>{},99463:(e,t,n)=>{"use strict";n.d(t,{e:()=>c});var s=n(64784),a=n(66491),r=n(6016),i=n(8380),l=n(30063);let o=["#FFD700","#FFAF00","#FF8205","#FA500F"];function c(e){let{animate:t=!1,size:n="md"}=e,c=(0,a.E)(),d=(0,i.useRef)(null),u=(0,i.useRef)(0),h=(0,i.useRef)(!1),m=(0,i.useCallback)(()=>{h.current&&(c.start(e=>({backgroundColor:o[(e-u.current+o.length)%o.length],transition:{duration:.15}})),u.current=(u.current+1)%o.length,d.current=requestAnimationFrame(()=>setTimeout(m,150)))},[c]);return(0,i.useEffect)(()=>(t?(h.current=!0,m()):(h.current=!1,d.current&&(cancelAnimationFrame(d.current),d.current=null),c.stop()),()=>{h.current=!1,d.current&&cancelAnimationFrame(d.current)}),[m,c,t]),(0,s.jsx)("div",{className:"flex w-min overflow-hidden rounded-2",children:[...Array(o.length)].map((e,t)=>(0,s.jsx)(r.P.div,{className:(0,l.cn)("sm"===n&&"h-4 w-1.5","md"===n&&"h-5 w-2"),style:{backgroundColor:o[t]},custom:t,animate:c,initial:{backgroundColor:o[t]}},t))})}}},e=>{e.O(0,[1716,2082,7795,4989,1318,4960,4458,3929,3706,9326,205,1526,9757,7960,3681,3171,3255,1948,9744,8539,5131,6536,7202,8424,6974,7513,5571,4748,3597,988,7358],()=>e(e.s=48937)),_N_E=e.O()}]);